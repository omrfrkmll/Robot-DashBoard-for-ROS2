<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="dashboardTitle">RobotFlow Kontrol Paneli</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <!-- Yeni Font: Space Mono (TÃ¼m dashboard iÃ§in) -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* TÃ¼m elemanlar iÃ§in temel stiller */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* CSS DeÄŸiÅŸkenleri - Tema ve Glassmorphism iÃ§in */
        :root {
            --glass-blur: 25px; /* ArtÄ±rÄ±lmÄ±ÅŸ bulanÄ±klÄ±k */
            --glass-bg-light: rgba(255, 255, 255, 0.1); /* AÃ§Ä±k tema cam arka plan */
            --glass-border-light: rgba(255, 255, 255, 0.1); /* AÃ§Ä±k tema cam kenarlÄ±k */
            --glass-shadow-light: rgba(0, 0, 0, 0.25); /* Daha gÃ¼Ã§lÃ¼ gÃ¶lge */

            --text-color-primary: #333; /* Grafik yazÄ±larÄ± iÃ§in varsayÄ±lan renk */
            --grid-color: rgba(0, 0, 0, 0.1); /* Grafik Ä±zgaralarÄ± iÃ§in varsayÄ±lan renk */

            /* Scrollbar Renkleri (AÃ§Ä±k Tema) */
            --scrollbar-track-color: rgba(255, 255, 255, 0.15); /* KaydÄ±rma Ã§ubuÄŸu izi rengi */
            --scrollbar-thumb-color: rgba(102, 126, 234, 0.7); /* AÃ§Ä±k temada parlayan kaydÄ±rma Ã§ubuÄŸu rengi */
            --scrollbar-thumb-hover-color: rgba(102, 126, 234, 1); /* Hover durumunda daha parlak */

            /* Glassmorphism Buton Renkleri (AÃ§Ä±k Tema) */
            --glass-button-bg-light: rgba(255, 255, 255, 0.2);
            --glass-button-border-light: rgba(255, 255, 255, 0.4);
            --glass-button-shadow-light: rgba(0, 0, 0, 0.1);
            --glass-button-text-light: #667eea; /* AÃ§Ä±k temada buton metin rengi */
        }

        /* Koyu Tema iÃ§in deÄŸiÅŸkenler */
        body.dark-theme {
            --glass-bg-dark: rgba(255, 255, 255, 0.05); /* Koyu tema cam arka plan */
            --glass-border-dark: rgba(255, 255, 255, 0.05); /* Koyu tema cam kenarlÄ±k */
            --glass-shadow-dark: rgba(0, 0, 0, 0.5); /* Daha gÃ¼Ã§lÃ¼ koyu gÃ¶lge */

            --text-color-primary: #e2e8f0; /* Koyu tema grafik yazÄ±larÄ± iÃ§in renk */
            --grid-color: rgba(255, 255, 255, 0.1); /* Koyu tema grafik Ä±zgaralarÄ± iÃ§in renk */

            /* Scrollbar Renkleri (Koyu Tema) */
            --scrollbar-track-color: rgba(15, 23, 42, 0.5); /* KaydÄ±rma Ã§ubuÄŸu izi rengi */
            --scrollbar-thumb-color: rgba(96, 165, 250, 0.7); /* Koyu temada parlayan kaydÄ±rma Ã§ubuÄŸu rengi */
            --scrollbar-thumb-hover-color: rgba(96, 165, 250, 1); /* Hover durumunda daha parlak */

            /* Glassmorphism Buton Renkleri (Koyu Tema) */
            --glass-button-bg-dark: rgba(255, 255, 255, 0.05); /* Ana koyu camdan daha aÃ§Ä±k */
            --glass-button-border-dark: rgba(255, 255, 255, 0.1);
            --glass-button-shadow-dark: rgba(0, 0, 0, 0.3);
            --glass-button-text-dark: #e2e8f0; /* Koyu temada buton metin rengi */
        }

        /* Body stilleri, dikey kaydÄ±rmaya izin verir */
        html, body {
            height: 100%; /* HTML ve body'nin viewport'u doldurmasÄ±nÄ± saÄŸlar */
            min-height: 100vh; /* Ä°Ã§eriÄŸin en az tam viewport yÃ¼ksekliÄŸini kaplamasÄ±nÄ± saÄŸlar */
            overflow-x: hidden; /* Yatay kaydÄ±rmayÄ± Ã¶nler */
            font-family: 'Space Mono', monospace; /* TÃ¼m dashboard iÃ§in Space Mono fontu uygulandÄ± */
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: all 0.5s ease; /* Tema deÄŸiÅŸiklikleri iÃ§in yumuÅŸak geÃ§iÅŸ */
        }

        /* Genel Webkit KaydÄ±rma Ã‡ubuÄŸu Stilleri */
        /* Bu stil, tÃ¼m kaydÄ±rÄ±labilir Ã¶ÄŸelerdeki Webkit tabanlÄ± kaydÄ±rma Ã§ubuklarÄ±nÄ± etkiler */
        ::-webkit-scrollbar {
            width: 5px; /* Ä°nce kaydÄ±rma Ã§ubuÄŸu */
        }
        ::-webkit-scrollbar-track {
            background: var(--scrollbar-track-color); /* Hafif ÅŸeffaf iz */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--scrollbar-thumb-color); /* Parlayan tutma yeri */
            border-radius: 10px;
            transition: background 0.3s ease; /* YumuÅŸak parlama geÃ§iÅŸi */
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--scrollbar-thumb-hover-color); /* Hover durumunda daha gÃ¼Ã§lÃ¼ parlama */
        }

        /* Firefox KaydÄ±rma Ã‡ubuÄŸu Stilleri */
        /* Bu stil, tÃ¼m kaydÄ±rÄ±labilir Ã¶ÄŸelerdeki Firefox tabanlÄ± kaydÄ±rma Ã§ubuklarÄ±nÄ± etkiler */
        @supports (-moz-appearance:none) {
            html, body, .left-sidebar, .right-sidebar, .camera-grid {
                scrollbar-width: thin; /* Ä°nce kaydÄ±rma Ã§ubuÄŸu */
                scrollbar-color: var(--scrollbar-thumb-color) var(--scrollbar-track-color); /* Tutma yeri sonra iz */
            }
        }


        /* AÃ§Ä±k Tema iÃ§in Body arka planÄ± (Dairesel Gradyan) */
        body {
            background: radial-gradient(circle at 30% 70%, #FFFDF6 0%, #FAF6E9 25%, #DDEB9D 75%, #A0C878 100%);
        }

        /* Koyu Tema iÃ§in body arka planÄ± (Dairesel Gradyan) */
        body.dark-theme {
            background: radial-gradient(circle at 70% 30%, #222831 0%, #31363F 25%, #76ABAE 75%, #EEEEEE 100%);
        }

        /* Navigasyon KartÄ± */
        .navbar-card {
            display: flex; /* Ä°Ã§indeki Ã¶ÄŸelerin hizalanmasÄ± iÃ§in */
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 2rem; /* KartÄ±n iÃ§ dolgusu */
            margin-bottom: 1rem; /* Grid Ã¶ÄŸeleri arasÄ±ndaki boÅŸluk */
            position: relative; /* DiÄŸer Ã¶ÄŸelerin Ã¼zerinde kalmasÄ± iÃ§in (isteÄŸe baÄŸlÄ±) */
            z-index: 1000; 
            transition: all 0.5s ease;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
            border-radius: 999px; /* Ã‡ok daha fazla yuvarlama - YarÄ±m Ã§ember efekti */
            
            /* Glassmorphism Efekti */
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            background: var(--glass-bg-light); /* Tekil rgba arka plan */
            border: 2px solid var(--glass-border-light); /* DoÄŸrudan kenarlÄ±k */
            /*box-shadow: 0 0 80px var(--glass-shadow-light); /* Yeni gÃ¶lge */
            color: var(--text-color-primary);
            /* overflow: hidden; */ /* Navbar'da taÅŸma olmamasÄ± iÃ§in bÄ±rakÄ±labilir, ancak butonlarÄ±n gÃ¶lgesini keser */
        }

        .dark-theme .navbar-card {
            background: var(--glass-bg-dark);
            border: 2px solid var(--glass-border-dark);
            /*box-shadow: 0 0 80px var(--glass-shadow-dark);*/
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s ease;
            margin-right: auto; /* Logo sola, menÃ¼ saÄŸa yaslanÄ±r */
        }

        .dark-theme .logo {
            color: #60a5fa;
        }

        .nav-menu {
            display: flex;
            gap: 2rem;
            align-items: center;
            flex-wrap: wrap; /* Nav Ã¶ÄŸeleri sÄ±ÄŸmazsa alt satÄ±ra geÃ§sin */
            justify-content: center; /* Ortala */
            flex-grow: 1; /* Ortadaki boÅŸluÄŸu doldursun */
        }

        .nav-item {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(102, 126, 234, 0.1);
            color: #667eea;
        }

        .dark-theme .nav-item:hover, 
        .dark-theme .nav-item.active {
            background: rgba(96, 165, 250, 0.2);
            color: #60a5fa;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.5rem; /* MenÃ¼ Ã§ubuÄŸuyla aynÄ± dikey padding */
            border-radius: 999px; /* YarÄ±m Ã§ember efekti iÃ§in artÄ±rÄ±ldÄ± */
            background: rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
            margin-left: auto; /* En saÄŸa yasla */
        }

        .dark-theme .user-profile {
            background: rgba(96, 165, 250, 0.2);
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .dark-theme .avatar {
            background: linear-gradient(45deg, #60a5fa, #3b82f6);
        }

        .theme-toggle {
            width: 50px;
            height: 26px;
            background: rgba(255, 255, 255, 0.3); /* AÃ§Ä±k modda cam efekti */
            border-radius: 13px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.4); /* Cam efekti kenarlÄ±k */
            outline: none;
            box-shadow: 0 0 10px rgba(0,0,0,0.1) inset; /* Ä°Ã§ gÃ¶lge */
        }

        .theme-toggle::after {
            content: 'â˜€ï¸'; /* AÃ§Ä±k tema iÃ§in gÃ¼neÅŸ ikonu */
            position: absolute;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .dark-theme .theme-toggle::after {
            content: 'ðŸŒ™'; /* Koyu tema iÃ§in ay ikonu */
            transform: translateX(24px); /* Toggle dairesini saÄŸa hareket ettirir */
            background: #1f2937;
        }

        /* KullanÄ±cÄ± Profili Dil SeÃ§ici */
        .language-select {
            padding: 0.4rem 0.8rem;
            border: 1px solid var(--glass-button-border-light);
            border-radius: 8px;
            background: var(--glass-button-bg-light);
            color: var(--glass-button-text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            font-size: 0.9rem;
            -webkit-appearance: none; /* VarsayÄ±lan select stilini kaldÄ±rÄ±r */
            -moz-appearance: none;
            appearance: none;
            /*background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23667eea' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); /* Ã–zel ok */
            background-repeat: no-repeat;
            background-position: right 0.8rem center;
            background-size: 1.2rem;
            margin-left: 1rem; /* Tema geÃ§iÅŸinden biraz uzaklaÅŸtÄ±r */
        }

        .dark-theme .language-select {
            background: var(--glass-button-bg-dark);
            border: 1px solid var(--glass-button-border-dark);
            color: var(--glass-button-text-dark);
            /*background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e2e8f0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");*/
        }

        .language-select:hover {
            background: rgba(102, 126, 234, 0.3);
        }

        .dark-theme .language-select:hover {
            background: rgba(96, 165, 250, 0.4);
        }

        /* Hamburger MenÃ¼ Ä°konu */
        .hamburger-icon {
            display: none; /* VarsayÄ±lan olarak gizli (masaÃ¼stÃ¼ iÃ§in) */
            font-size: 2rem;
            cursor: pointer;
            color: var(--text-color-primary);
            transition: color 0.3s ease;
            z-index: 1001; /* DiÄŸer navbar Ã¶ÄŸelerinin Ã¼zerinde */
        }

        /* Mobil MenÃ¼ KatmanÄ± */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9); /* Koyu yarÄ± saydam arka plan */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 2000; /* TÃ¼m iÃ§eriÄŸin Ã¼zerinde */
            display: flex;
            justify-content: center;
            align-items: center;
            transform: translateX(100%); /* BaÅŸlangÄ±Ã§ta ekran dÄ±ÅŸÄ± */
            transition: transform 0.3s ease-in-out;
            opacity: 0; /* BaÅŸlangÄ±Ã§ta gizli */
            visibility: hidden; /* Clickable olmasÄ±nÄ± engelle */
        }

        .mobile-menu-overlay.show {
            transform: translateX(0); /* GÃ¶rÃ¼ntÃ¼lemek iÃ§in iÃ§eri kaydÄ±r */
            opacity: 1; /* GÃ¶rÃ¼nÃ¼r yap */
            visibility: visible; /* Clickable yap */
        }

        .mobile-menu-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
            padding: 2rem;
            width: 80%; /* Mobil menÃ¼ iÃ§eriÄŸinin geniÅŸliÄŸi */
            max-width: 400px;
            background: var(--glass-bg-light); /* Temayla uyumlu arka plan */
            border-radius: 25px;
            border: 2px solid var(--glass-border-light);
            box-shadow: 0 0 80px var(--glass-shadow-light);
            color: var(--text-color-primary);
        }

        .dark-theme .mobile-menu-content {
            background: var(--glass-bg-dark);
            border: 2px solid var(--glass-border-dark);
            box-shadow: 0 0 80px var(--glass-shadow-dark);
        }

        /* Mobil menÃ¼ iÃ§indeki nav ve user profile stilleri */
        .mobile-menu-content .nav-menu,
        .mobile-menu-content .user-profile {
            flex-direction: column; /* Mobil menÃ¼de dikey yÄ±ÄŸÄ±lma */
            width: 100%;
            align-items: center;
            gap: 1rem;
        }

        .mobile-menu-content .nav-item {
            width: 100%;
            text-align: center;
            font-size: 1.2rem;
            padding: 1rem;
        }

        .mobile-menu-content .user-profile {
            margin-top: 2rem;
            padding: 1rem;
            border-radius: 15px;
            background: rgba(102, 126, 234, 0.2); /* FarklÄ± bir arka plan */
            justify-content: center;
        }

        .dark-theme .mobile-menu-content .user-profile {
            background: rgba(96, 165, 250, 0.3);
        }

        .mobile-menu-content .avatar {
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
        }

        .mobile-menu-content .language-select,
        .mobile-menu-content .theme-toggle {
            margin: 1rem auto; /* Ortala */
        }

        /* Kapatma butonu */
        .close-mobile-menu {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 2.5rem;
            color: white;
            cursor: pointer;
            z-index: 2001; /* Kapatma dÃ¼ÄŸmesinin her ÅŸeyin Ã¼zerinde olduÄŸundan emin olun */
        }

        .close-mobile-menu:hover {
            color: #ef4444;
        }


        /* Ana DÃ¼zen Konteyneri */
        .main-container {
            display: grid;
            /* YÃ¼ksekliÄŸi belirlemek iÃ§in 1fr kullanÄ±yoruz */
            grid-template-columns: 300px 2fr 1.2fr; /* Sol Kenar Ã‡ubuÄŸu | Harita | SaÄŸ Kenar Ã‡ubuÄŸu */
            grid-template-rows: auto 1fr auto; /* Navbar | Ä°Ã§erik (kenar Ã§ubuklarÄ±/harita) | Kamera */
            grid-template-areas:
                "navbar-area    navbar-area     navbar-area"
                "sidebar-left   main-map        sidebar-right"
                "camera-section camera-section  camera-section"; /* Kamera tÃ¼m sÃ¼tunlara yayÄ±lÄ±r */
            gap: 0.75rem; /* Kartlar arasÄ±ndaki boÅŸluk azaltÄ±ldÄ± */
            padding: 1rem;
            height: 100vh; /* Ana konteynerin tÃ¼m viewport yÃ¼ksekliÄŸini almasÄ±nÄ± saÄŸlar */
            overflow-y: auto; /* Ana iÃ§erik alanÄ± iÃ§in dikey kaydÄ±rmaya izin verir */
            overflow-x: hidden; /* Ana iÃ§erikte yatay kaydÄ±rmayÄ± Ã¶nler */
        }
        
        /* Navbar'Ä±n grid alanÄ±na atanmasÄ± */
        .navbar-card {
            grid-area: navbar-area;
        }

        /* TÃ¼m glassmorphism panelleri iÃ§in temel stil */
        .glass-panel {
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            background: var(--glass-bg-light); /* Tekil rgba arka plan */
            border: 2px solid var(--glass-border-light); /* DoÄŸrudan kenarlÄ±k */
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            border-radius: 25px; /* KÃ¶ÅŸe yuvarlama tutarlÄ± hale getirildi */
            /*box-shadow: 0 0 80px var(--glass-shadow-light); /* Yeni gÃ¶lge */
            position: relative; /* DiÄŸer Ã¶ÄŸelerin Ã¼zerinde kalmasÄ± iÃ§in */
            overflow: hidden; /* KenarlÄ±klarÄ±n taÅŸmasÄ±nÄ± engelle */
            transition: all 0.5s ease; /* Tema ve diÄŸer geÃ§iÅŸler iÃ§in */
            padding: 1.5rem; /* Panellerin iÃ§ dolgusu */
        }
        
        /* Kenar Ã§ubuÄŸu ve harita konteynerleri iÃ§in ortak stiller */
        .left-sidebar, .map-container, .camera-container {
            /* Bu sÄ±nÄ±flar artÄ±k glass-panel'den gÃ¶rsel stilleri devralÄ±yor */
            transition: all 0.5s ease;
            position: relative; 
        }

        /* Sol Kenar Ã‡ubuÄŸu - Robot Listesi */
        .left-sidebar {
            grid-area: sidebar-left; /* Grid alanÄ±na ata */
            height: 100%; /* BulunduÄŸu grid satÄ±rÄ±nÄ±n tÃ¼m yÃ¼ksekliÄŸini alÄ±r */
            overflow-y: auto; /* Robot listesi iÃ§in kaydÄ±rmaya izin verir */
            overscroll-behavior-y: contain; /* KaydÄ±rma bittiÄŸinde elemanÄ±n sÄ±kÄ±ÅŸmasÄ±nÄ± saÄŸlar */
            padding: 1.5rem; /* TutarlÄ± padding */
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Ä°Ã§erik bÃ¶lÃ¼mlerini dikeyde yayar */
            align-items: stretch; /* Ä°Ã§erik Ã¶ÄŸelerinin geniÅŸliÄŸi doldurmasÄ±nÄ± saÄŸlar */
            min-height: 300px; /* Minimum yÃ¼kseklik, iÃ§eriÄŸin kÄ±sa olduÄŸu durumlarda */
        }

        /* Robot listesini ve baÅŸlÄ±ÄŸÄ±nÄ± kapsayan flex Ã¶ÄŸesi */
        .sidebar-robot-list-section {
            display: flex;
            flex-direction: column;
            flex-grow: 1; /* Mevcut alanÄ± doldurmasÄ±nÄ± saÄŸlar */
            justify-content: center; /* Dikeyde ortalamaya Ã§alÄ±ÅŸÄ±r */
            margin-bottom: 1rem; /* HÄ±zlÄ± iÅŸlemlerden ayÄ±rma */
        }

        /* HÄ±zlÄ± iÅŸlemler kÄ±smÄ±, otomatik olarak dibe itilir */
        .quick-actions-section {
            margin-top: auto; /* Bu Ã¶ÄŸeyi en alta iter */
        }

        .sidebar-title-container { /* BaÅŸlÄ±k ve butonlarÄ± aynÄ± satÄ±rda tutmak iÃ§in yeni kapsayÄ±cÄ± */
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.3s ease;
            margin-right: auto; /* ButonlarÄ±n saÄŸa yaslanmasÄ±nÄ± saÄŸlar */
        }

        /* Quick actions bÃ¶lÃ¼mÃ¼ndeki baÅŸlÄ±k iÃ§in Ã¼st boÅŸluk */
        .quick-actions-section .sidebar-title {
            margin-top: 2rem; 
            margin-bottom: 1rem;
        }

        /* Sol kenar Ã§ubuÄŸu butonlarÄ± iÃ§in glassmorphism */
        .sidebar-action-btn {
            background: var(--glass-button-bg-light);
            border: 1px solid var(--glass-button-border-light);
            /* box-shadow: 0 4px 10px var(--glass-button-shadow-light); */
            backdrop-filter: blur(10px); /* Daha az bulanÄ±klÄ±k */
            -webkit-backdrop-filter: blur(10px);
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--glass-button-text-light); /* Temaya gÃ¶re metin rengi */
            transition: all 0.3s ease;
            padding: 0.2rem; /* TÄ±klama alanÄ± iÃ§in */
            border-radius: 5px;
            margin-left:5px;
            margin-right:5px;
        }

        .dark-theme .sidebar-action-btn {
            background: var(--glass-button-bg-dark);
            border: 1px solid var(--glass-button-border-dark);
            /* box-shadow: 0 4px 10px var(--glass-button-shadow-dark); */
            color: var(--glass-button-text-dark); /* Koyu temada metin rengi beyaz */
        }

        .sidebar-action-btn:hover {
            background: rgba(102, 126, 234, 0.3); /* Hover'da daha opak */
            transform: scale(1.1);
        }
        .dark-theme .sidebar-action-btn:hover {
            background: rgba(96, 165, 250, 0.4); /* Dark temada hover'da daha opak */
        }

        .robot-item {
            padding: 1rem;
            margin-bottom: 0.5rem;
            background: rgba(255, 255, 255, 0.4); /* Cam efekti arka plan */
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.6); /* Cam efekti kenarlÄ±k */
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            width: 100%; /* Ekran geniÅŸliÄŸine adaptif olmasÄ± iÃ§in tam geniÅŸlik */
        }

        .dark-theme .robot-item {
            background: rgba(51, 65, 85, 0.7);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .robot-item:hover, .robot-item.active {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .dark-theme .robot-item:hover, 
        .dark-theme .robot-item.active {
            border-color: #60a5fa;
            box-shadow: 0 4px 15px rgba(96, 165, 250, 0.3);
        }

        .robot-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
            transition: color 0.3s ease;
            font-size: clamp(1rem, 2.5vw, 1.1rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
        }

        .dark-theme .robot-name {
            color: #f1f5f9;
        }

        .robot-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: clamp(0.8rem, 2vw, 0.9rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: color 0.3s ease;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
        }

        .status-indicator.offline {
            background: #ef4444;
        }

        .status-indicator.warning {
            background: #f59e0b;
        }

        /* Merkez Alan - Harita */
        .map-container {
            grid-area: main-map; /* Grid alanÄ±na ata */
            height: 100%; /* BulunduÄŸu grid satÄ±rÄ±nÄ±n tÃ¼m yÃ¼ksekliÄŸini alÄ±r */
            position: relative;
            overflow: hidden;
            flex-grow: 1; /* HaritanÄ±n yÄ±ÄŸÄ±lmÄ±ÅŸ dÃ¼zende kullanÄ±labilir alanÄ± kaplamasÄ±nÄ± saÄŸlar */
        }

        .map-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
        }

        .map-title {
            font-size: clamp(1.1rem, 2.5vw, 1.3rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            font-weight: 600;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: color 0.3s ease;
        }

        .map-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
        }

        /* Harita ve HÄ±zlÄ± Ä°ÅŸlem butonlarÄ± iÃ§in glassmorphism */
        .control-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--glass-button-border-light);
            border-radius: 8px;
            background: var(--glass-button-bg-light);
            color: var(--glass-button-text-light); /* Temaya gÃ¶re metin rengi */
            cursor: pointer;
            transition: all 0.3s ease;
            /* box-shadow: 0 4px 10px var(--glass-button-shadow-light); */
            backdrop-filter: blur(10px); /* Daha az bulanÄ±klÄ±k */
            -webkit-backdrop-filter: blur(10px);
        }

        .dark-theme .control-btn {
            background: var(--glass-button-bg-dark);
            border: 1px solid var(--glass-button-border-dark);
            /* box-shadow: 0 4px 10px var(--glass-button-shadow-dark); */
            color: var(--glass-button-text-dark); /* Koyu temada metin rengi beyaz */
        }

        .control-btn:hover {
            background: rgba(102, 126, 234, 0.3); /* Hover'da daha opak */
            transform: translateY(-1px);
        }

        .dark-theme .control-btn:hover {
            background: rgba(96, 165, 250, 0.4); /* Dark temada hover'da daha opak */
        }

        .map-canvas {
            width: 100%;
            height: calc(100% - 60px); /* BaÅŸlÄ±ÄŸa gÃ¶re yÃ¼ksekliÄŸi ayarlar */
            background: rgba(255, 255, 255, 0.3); /* Cam efekti arka plan */
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.6); /* Cam efekti kenarlÄ±k */
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .dark-theme .map-canvas {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .robot-map-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Robot markerlarÄ±n altÄ±nda kalmalÄ± */
        }

        .svg-grid-bg {
            fill: url(#smallGrid);
            transition: all 0.3s ease;
        }

        .dark-theme .svg-grid-bg {
            fill: url(#darkGrid);
        }

        /* Kamera AkÄ±ÅŸÄ± Konteyneri */
        .camera-container {
            grid-area: camera-section; /* Grid alanÄ±na ata */
            min-height: 300px;
            height: auto;
            max-height: 400px; /* Ä°Ã§erik kÄ±sa ise yÄ±ÄŸÄ±lmÄ±ÅŸ gÃ¶rÃ¼nÃ¼mde yÃ¼ksekliÄŸi sÄ±nÄ±rlar */
            overflow: hidden; /* Dahili kamera Ä±zgarasÄ±nÄ±n taÅŸmasÄ±nÄ± yÃ¶netir */
            width: 100%; /* Ekran geniÅŸliÄŸine adaptif olmasÄ± iÃ§in tam geniÅŸlik */
        }

        .camera-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
        }

        .camera-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: color 0.3s ease;
        }

        .camera-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
        }

        .camera-select {
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.6); /* Cam efekti kenarlÄ±k */
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.4); /* Cam efekti arka plan */
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            font-size: clamp(0.8rem, 2vw, 0.9rem); /* Minimum, viewport'a gÃ¶re, maksimum deÄŸer */
        }

        .dark-theme .camera-select {
            background: rgba(51, 65, 85, 0.7);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .camera-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            background: #667eea;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); /* Buton gÃ¶lgesi */
        }

        .dark-theme .camera-btn {
            background: #60a5fa;
        }

        .camera-btn:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        .dark-theme .camera-btn:hover {
            background: #3b82f6;
        }

        .camera-grid {
            display: grid;
            /* Kamera akÄ±ÅŸlarÄ± iÃ§in uyarlanabilir Ä±zgara */
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 1rem;
            height: calc(100% - 60px); /* BaÅŸlÄ±ÄŸa gÃ¶re yÃ¼ksekliÄŸi ayarlar */
            min-height: 200px;
            overflow-y: auto; /* Ã‡ok sayÄ±da akÄ±ÅŸ varsa kamera Ä±zgarasÄ± iÃ§inde kaydÄ±rmaya izin verir */
        }

        .camera-stream {
            background: rgba(255, 255, 255, 0.3); /* AÃ§Ä±k modda daha transparan */
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.6); /* Cam efekti kenarlÄ±k */
            transition: all 0.3s ease;
            height: 100%; /* Izgaradaki kullanÄ±labilir yÃ¼ksekliÄŸi doldurur */
            min-height: 180px; /* Her akÄ±ÅŸ iÃ§in minimum yÃ¼kseklik */
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05); /* Daha hafif gÃ¶lge */
        }

        .dark-theme .camera-stream {
            background: rgba(15, 23, 42, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .camera-stream:hover {
            border-color: #667eea;
        }

        .dark-theme .camera-stream:hover {
            border-color: #60a5fa;
        }

        .camera-stream.active {
            border-color: #f59e0b;
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
        }

        .stream-header {
            background: rgba(0, 0, 0, 0.6); /* Daha transparan */
            color: white;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            font-weight: 500;
            position: absolute; /* .camera-stream'a gÃ¶re konumlandÄ±rÄ±lmÄ±ÅŸ */
            top: 0;
            left: 0;
            right: 0;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .stream-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .stream-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #ef4444; /* KÄ±rmÄ±zÄ± (etkin deÄŸil) */
            animation: pulse 2s infinite;
        }

        .stream-indicator.live {
            background: #22c55e; /* YeÅŸil (canlÄ±) */
        }

        .stream-video {
            width: 100%;
            flex-grow: 1; /* Videonun kalan alanÄ± doldurmasÄ±nÄ± saÄŸlar */
            object-fit: cover;
            background: #1f2937;
            display: block; /* Videonun altÄ±ndaki fazla boÅŸluÄŸu kaldÄ±rÄ±r */
        }

        .stream-placeholder {
            width: 100%;
            flex-grow: 1; /* Yer tutucunun kalan alanÄ± doldurmasÄ±nÄ± saÄŸlar */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            font-size: clamp(0.7rem, 1.5vw, 0.9rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(0,0,0,0.03) 10px, /* Daha hafif Ã§izgi */
                rgba(0,0,0,0.03) 20px
            );
        }

        .dark-theme .stream-placeholder {
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255,255,255,0.05) 10px,
                rgba(255,255,255,0.05) 20px
            );
        }

        .stream-overlay {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.6); /* Daha transparan */
            color: white;
            padding: 0.5rem;
            border-radius: 8px;
            font-size: clamp(0.6rem, 1.2vw, 0.8rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
        }

        .snapshot-btn, .fullscreen-btn {
            background: rgba(0, 0, 0, 0.5); /* Daha transparan */
            backdrop-filter: blur(5px); /* Hafif bulanÄ±klÄ±k */
            border: 1px solid rgba(255, 255, 255, 0.3); /* Cam efekti kenarlÄ±k */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .snapshot-btn:hover, .fullscreen-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        /* Fullscreen modal */
        .fullscreen-modal {
            position: fixed; /* Daha iyi gÃ¶rÃ¼ntÃ¼ iÃ§in sabitleÅŸtirildi */
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.95);
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .fullscreen-modal.show {
            display: flex;
        }

        .fullscreen-video {
            max-width: 90vw;
            max-height: 90vh;
            border-radius: 12px;
        }

        .close-fullscreen {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            font-size: 1.5rem;
            transition: all 0.3s ease;
        }

        .close-fullscreen:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        /* SaÄŸ Kenar Ã‡ubuÄŸu - Durum KartlarÄ± */
        .right-sidebar {
            grid-area: sidebar-right; /* Grid alanÄ±na ata */
            height: 100%; /* BulunduÄŸu grid satÄ±rÄ±nÄ±n tÃ¼m yÃ¼ksekliÄŸini alÄ±r */
            display: flex;
            flex-direction: column; /* KartlarÄ± dikey olarak yÄ±ÄŸar */
            gap: 1rem;
            /*overflow-y: auto; /* Kartlar iÃ§in kaydÄ±rmaya izin verir */
            overscroll-behavior-y: contain; /* KaydÄ±rma bittiÄŸinde elemanÄ±n sÄ±kÄ±ÅŸmasÄ±nÄ± saÄŸlar */
            min-width: 300px; /* Esnek olsa bile minimum geniÅŸlik saÄŸlar */
            width: 100%; /* Ekran geniÅŸliÄŸine adaptif olmasÄ± iÃ§in tam geniÅŸlik */
        }
            
        .status-card {
            min-height: 120px; /* KartlarÄ±n minimum yÃ¼ksekliÄŸe sahip olmasÄ±na izin verir */
            user-select: none; /* SÃ¼rÃ¼kleme sÄ±rasÄ±nda metin seÃ§imini Ã¶nler */
            width: 100%; /* Ekran geniÅŸliÄŸine adaptif olmasÄ± iÃ§in tam geniÅŸlik */
            display: flex; /* Ä°Ã§eriÄŸin dÃ¼zenlenmesi iÃ§in flexbox */
            flex-direction: column; /* Ä°Ã§eriÄŸi dikey olarak hizala */
            justify-content: space-between; /* Ä°Ã§eriÄŸi dikeyde eÅŸit daÄŸÄ±t */
            padding: 1.5rem; /* Ä°Ã§ dolgu */
            transition: all 0.5s ease; /* Tema ve diÄŸer geÃ§iÅŸler iÃ§in */
            
            /* Glassmorphism Efekti - Sadece bu kartlara Ã¶zgÃ¼ */
            backdrop-filter: blur(var(--glass-blur));
            -webkit-backdrop-filter: blur(var(--glass-blur));
            background: var(--glass-bg-light); /* Tekil rgba arka plan */
            border: 2px solid var(--glass-border-light); /* DoÄŸrudan kenarlÄ±k */
            /*box-shadow: 0 0 80px var(--glass-shadow-light); /* Yeni gÃ¶lge */
            color: var(--text-color-primary);
            border-radius: 25px; /* KÃ¶ÅŸe yuvarlama artÄ±rÄ±ldÄ± */
            position: relative;
            overflow: hidden;
            cursor: grab; /* Sadece sÃ¼rÃ¼klemek istenen Ã¶ÄŸelerde imleÃ§ */
        }
        
        /* SÃ¼rÃ¼klenebilir kartlar iÃ§in hover efekti */
        .right-sidebar .status-card:hover {
            transform: translateY(-2px);
        }
        .dark-theme .right-sidebar .status-card:hover { 
            /* box-shadow kaldÄ±rÄ±ldÄ±, bu kartlarda zaten yok */
        }

        /* SÃ¼rÃ¼klenen Ã¶ÄŸe iÃ§in stil (hayalet gÃ¶rÃ¼ntÃ¼) */
        .status-card.dragging {
            opacity: 0.5; /* SÃ¼rÃ¼klÃ¼ Ã¶ÄŸeyi yarÄ± saydam yapar */
            border: 2px dashed #667eea; /* GÃ¶rsel geri bildirim iÃ§in kesik Ã§izgi kenarlÄ±k */
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .card-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .battery-icon {
            background: linear-gradient(45deg, #22c55e, #16a34a);
            color: white;
        }

        .location-icon {
            background: linear-gradient(45deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .speed-icon {
            background: linear-gradient(45deg, #f59e0b, #d97706);
            color: white;
        }

        .temp-icon {
            background: linear-gradient(45deg, #ef4444, #dc2626);
            color: white;
        }

        .card-title {
            font-weight: 600;
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: color 0.3s ease;
            font-size: clamp(1rem, 2.5vw, 1.1rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
        }

        .card-value {
            font-size: clamp(1.5rem, 4vw, 1.8rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            font-weight: bold;
            color: #667eea;
            margin: 0.5rem 0;
            transition: color 0.3s ease;
        }

        .dark-theme .card-value {
            color: #60a5fa;
        }

        .card-details {
            display: flex;
            justify-content: space-between;
            font-size: clamp(0.7rem, 1.8vw, 0.9rem); /* Ä°Ã§eriÄŸin adaptif olmasÄ± iÃ§in font boyutu responsive olabilir */
            color: var(--text-color-primary); /* Metin rengi tema deÄŸiÅŸkeninden alÄ±nÄ±r */
            transition: color 0.3s ease;
            flex-wrap: wrap; /* KÃ¼Ã§Ã¼k ekranlarda sÄ±ÄŸmazsa alt alta geÃ§mesi iÃ§in */
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.4); /* Cam efekti arka plan */
            border-radius: 4px;
            margin: 0.5rem 0;
            overflow: hidden;
            transition: background 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.6); /* Cam efekti kenarlÄ±k */
        }

        .dark-theme .progress-bar {
            background: rgba(55, 65, 81, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #16a34a);
            transition: width 0.3s ease;
        }

        /* Chart container for status cards */
        .status-card .chart-container {
            width: 100%; /* GrafiÄŸin kartÄ±n tam geniÅŸliÄŸini kaplamasÄ± iÃ§in */
            height: 80px; /* GrafiÄŸin yÃ¼ksekliÄŸi */
            margin-top: 1rem;
            position: relative; /* Canvas'Ä±n iÃ§indeki iÃ§eriÄŸin position: absolute kullanmasÄ± iÃ§in */
        }

        /* Chart.js canvas'Ä±nÄ± esnek hale getir */
        .status-card canvas {
            max-width: 100%;
            height: 100% !important; /* Chart.js inline height ekleyebilir, bu onu geÃ§ersiz kÄ±lar */
            width: 100% !important;
            min-height: 0; /* Gerekirse kÃ¼Ã§Ã¼lmeye izin ver */
        }

        /* Responsive TasarÄ±m */
        @media (max-width: 1200px) {
            .main-container {
                /* Biraz daha kÃ¼Ã§Ã¼k masaÃ¼stleri iÃ§in sÃ¼tunlarÄ± ayarlar */
                grid-template-columns: 250px 2fr 1.5fr; 
            }
        }

        @media (max-width: 1000px) { /* Tablet ve daha kÃ¼Ã§Ã¼k ekranlar iÃ§in */
            .main-container {
                /* Tablet ve daha kÃ¼Ã§Ã¼k masaÃ¼stÃ¼: yÄ±ÄŸÄ±lmÄ±ÅŸ dÃ¼zen */
                grid-template-columns: 1fr; /* Tek sÃ¼tun */
                grid-template-rows: auto; /* YÃ¼kseklik iÃ§eriÄŸe gÃ¶re ayarlanÄ±r */
                grid-template-areas:
                    "navbar-area" /* Navbar da yÄ±ÄŸÄ±lmÄ±ÅŸ dÃ¼zene dahil */
                    "sidebar-left"
                    "main-map"
                    "sidebar-right"
                    "camera-section"; /* TÃ¼m elemanlar dikey olarak yÄ±ÄŸÄ±lÄ±r */
                height: auto;
                min-height: 100vh;
                display: flex;
                flex-direction: column; /* ElemanlarÄ± dikey olarak yÄ±ÄŸar */
                gap: 0.75rem; /* Kartlar arasÄ±ndaki boÅŸluk tutarlÄ± hale getirildi */
                overflow-y: auto; /* KaydÄ±rmanÄ±n etkinleÅŸtirildiÄŸinden emin olur */
            }
            
            /* MasaÃ¼stÃ¼ menÃ¼sÃ¼nÃ¼ ve kullanÄ±cÄ± profilini gizle */
            .nav-menu, .user-profile {
                display: none; 
            }
            /* Hamburger ikonunu gÃ¶ster */
            .hamburger-icon {
                display: block; 
                margin-left: auto; /* Ä°konu saÄŸa yasla */
            }
            .navbar-card {
                justify-content: space-between; /* Logo ve hamburger arasÄ±nda boÅŸluk */
                flex-wrap: nowrap; /* ArtÄ±k Ã¶ÄŸelerin sarÄ±lmasÄ±na izin verme */
            }

            /* Daha iyi tablet akÄ±ÅŸÄ± iÃ§in elemanlarÄ± sÄ±ralar */
            .navbar-card { order: 0; margin-bottom: 0.75rem;} /* Navbar en Ã¼stte */
            .left-sidebar { order: 1; min-height: 200px; max-height: 300px; }
            .map-container { order: 2; min-height: 400px; height: 50vh; }
            .right-sidebar { order: 3; display: flex; flex-direction: column; gap: 0.75rem; }
            .camera-container { order: 4; /* KameranÄ±n en altta olmasÄ±nÄ± saÄŸlar */
                max-height: none; /* YÄ±ÄŸÄ±lmÄ±ÅŸ gÃ¶rÃ¼nÃ¼mde maksimum yÃ¼kseklik yok */
                height: auto; /* Ä°Ã§eriÄŸe yÃ¼ksekliÄŸi uyarlar */
                min-height: 350px;
            }

            .camera-grid {
                /* Tabletler iÃ§in kamera Ä±zgarasÄ±nÄ± ayarlar */
                grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                min-height: 250px;
                height: auto;
            }

            .camera-stream {
                height: 250px; /* Tablette bireysel akÄ±ÅŸlar iÃ§in makul bir yÃ¼kseklik ayarlar */
            }

            /* SaÄŸ kenar Ã§ubuÄŸundaki durum kartlarÄ±, yeterli alan varsa tablet Ã¼zerinde bir Ä±zgara olabilir */
            .right-sidebar > .status-card {
                /* SÃ¼tun iÃ§inde esnek olduklarÄ±ndan emin olun */
                width: 100%;
                margin-bottom: 0; /* SÃ¼rÃ¼kle ve bÄ±rak'tan gelen ekstra kenar boÅŸluÄŸunu kaldÄ±rÄ±r */
            }

            /* Durum kartlarÄ±nÄ±n tablet Ã¼zerinde saÄŸ kenar Ã§ubuÄŸunda bir Ä±zgara olmasÄ±nÄ± isterseniz: */
            .right-sidebar.grid-on-tablet { /* Ekran boyutu gerektiriyorsa bu sÄ±nÄ±fÄ± JS'de ekleyin */
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                gap: 0.75rem;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                gap: 0.5rem;
                padding: 0.5rem;
            }
            
            .left-sidebar {
                min-height: 150px;
                max-height: 200px;
            }

            .map-container {
                min-height: 300px;
                height: 40vh;
            }

            .camera-container {
                padding: 1rem;
                min-height: 400px;
            }

            .camera-grid {
                grid-template-columns: 1fr; /* Daha kÃ¼Ã§Ã¼k tabletlerde kamera akÄ±ÅŸlarÄ± iÃ§in tek sÃ¼tun */
                gap: 0.5rem;
                min-height: 300px;
            }

            .camera-stream {
                height: 200px;
                min-height: 180px;
            }

            .right-sidebar {
                grid-template-columns: 1fr; /* KÃ¼Ã§Ã¼k tabletlerde/telefonlarda durum kartlarÄ±nÄ± dikey olarak yÄ±ÄŸar */
                gap: 0.5rem;
            }

            .status-card {
                padding: 1rem;
                min-height: 100px;
            }

            .camera-controls {
                flex-wrap: wrap;
                gap: 0.25rem;
            }

            .camera-btn {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }

            .camera-select {
                font-size: 0.9rem;
            }

            /* Mobil Ã¶zel iyileÅŸtirmeler */
            .stream-header {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }

            .stream-overlay {
                font-size: 0.7rem;
                padding: 0.3rem 0.5rem;
            }

            .snapshot-btn, .fullscreen-btn {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 0.25rem;
                gap: 0.25rem;
            }

            .navbar-card {
                padding: 0.5rem 1rem;
                flex-direction: row; /* Mobil gÃ¶rÃ¼nÃ¼mde hala yanyana */
                align-items: center;
                gap: 0.5rem;
            }
            .navbar-card .logo {
                margin-right: auto; /* Logo sola */
            }
            .hamburger-icon {
                margin-left: 0; /* Hamburger ikonunu olduÄŸu yerde tut */
            }
            /* Hamburger menÃ¼ aÃ§Ä±kken de bu stiller etkili olmalÄ± */
            .mobile-menu-content .nav-menu {
                gap: 0.5rem;
            }
            .mobile-menu-content .nav-item {
                font-size: 1.1rem;
                padding: 0.8rem;
            }
            .mobile-menu-content .user-profile {
                margin-top: 1.5rem;
                padding: 0.8rem;
            }
            .mobile-menu-content .avatar {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            .mobile-menu-content .language-select,
            .mobile-menu-content .theme-toggle {
                margin: 0.8rem auto;
            }


            .camera-container {
                padding: 0.75rem;
                min-height: 350px;
            }

            .camera-header {
                flex-direction: column;
                gap: 0.5rem;
                align-items: stretch;
            }

            .camera-controls {
                justify-content: center;
            }

            .camera-grid {
                min-height: 250px;
            }

            .camera-stream {
                height: 180px;
                min-height: 160px;
            }

            .left-sidebar, .map-container, .camera-container, .status-card {
                border-radius: 10px;
            }
        }

        /* Animasyonlar */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .notification {
            position: fixed; /* Daha iyi gÃ¶rÃ¼ntÃ¼ iÃ§in sabitleÅŸtirildi */
            top: 100px;
            right: 20px;
            background: white;
            padding: 1rem;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 2000; /* Bildirimin diÄŸer Ã¶ÄŸelerin Ã¼stÃ¼nde olmasÄ±nÄ± saÄŸlar */
            min-width: 250px;
        }

        .notification.show {
            transform: translateX(0);
        }

        /* Yeni Modal Stilleri - Robot Analizi iÃ§in */
        .analysis-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .analysis-modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .analysis-modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(-20px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            color: #333; /* Darker text for readability */
        }

        .dark-theme .analysis-modal-content {
            background: #1f2937;
            color: #e2e8f0;
        }

        .analysis-modal-overlay.show .analysis-modal-content {
            transform: translateY(0);
            opacity: 1;
        }

        .analysis-modal-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #667eea;
            transition: color 0.2s ease;
        }

        .dark-theme .analysis-modal-close-btn {
            color: #60a5fa;
        }

        .analysis-modal-close-btn:hover {
            color: #dc2626;
        }

        .analysis-modal-title {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: #667eea;
        }

        .dark-theme .analysis-modal-title {
            color: #60a5fa;
        }

        .analysis-modal-body {
            line-height: 1.6;
            white-space: pre-wrap; /* SatÄ±r sonlarÄ±nÄ± koru */
        }

        .analysis-loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none; /* VarsayÄ±lan olarak gizli */
        }

        .dark-theme .analysis-loading-spinner {
            border-top: 4px solid #60a5fa;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Ana Konteyner -->
    <div class="main-container">
        <!-- Ãœst Navigasyon - Åžimdi bir Kart! -->
        <div class="navbar-card">
            <div class="logo">
                <span>ðŸ¤–</span>
                RobotFlow
            </div>
            <!-- Hamburger menÃ¼ ikonu -->
            <div class="hamburger-icon" id="hamburgerIcon" onclick="toggleMobileMenu()">â˜°</div>

            <!-- Mobil menÃ¼ kapsayÄ±cÄ±sÄ± -->
            <div class="mobile-menu-overlay" id="mobileMenuOverlay">
                <div class="close-mobile-menu" onclick="toggleMobileMenu()">âœ–</div>
                <div class="mobile-menu-content">
                    <div class="nav-menu">
                        <a href="#" class="nav-item active" data-lang-key="navDashboard">Dashboard</a>
                        <a href="#" class="nav-item" data-lang-key="navMaps">Haritalar</a>
                        <a href="#" class="nav-item" data-lang-key="navAnalytics">Analizler</a>
                        <a href="#" class="nav-item" data-lang-key="navSettings">Ayarlar</a>
                    </div>
                    <div class="user-profile">
                        <div class="avatar">AU</div>
                        <div>
                            <div style="font-weight: 600;">Admin User</div>
                            <div style="font-size: 0.8rem; color: #6b7280;">admin@robotflow.com</div>
                        </div>
                        <select class="language-select" id="languageSelect" onchange="switchLanguage(this.value)">
                            <option value="en">English</option>
                            <option value="tr">TÃ¼rkÃ§e</option>
                        </select>
                        <button class="theme-toggle" onclick="toggleTheme()"></button>
                    </div>
                </div>
            </div>
            
            <div class="nav-menu">
                <a href="#" class="nav-item active" data-lang-key="navDashboard">Dashboard</a>
                <a href="#" class="nav-item" data-lang-key="navMaps">Haritalar</a>
                <a href="#" class="nav-item" data-lang-key="navAnalytics">Analizler</a>
                <a href="#" class="nav-item" data-lang-key="navSettings">Ayarlar</a>
            </div>
            <div class="user-profile">
                <div class="avatar">AU</div>
                <div>
                    <div style="font-weight: 600;">Admin User</div>
                    <div style="font-size: 0.8rem; color: #6b7280;">admin@robotflow.com</div>
                </div>
                <select class="language-select" id="languageSelect" onchange="switchLanguage(this.value)">
                    <option value="en">English</option>
                    <option value="tr">TÃ¼rkÃ§e</option>
                </select>
                <button class="theme-toggle" onclick="toggleTheme()"></button>
            </div>
        </div>

        <!-- Sol Kenar Ã‡ubuÄŸu - Robot Listesi -->
        <div class="left-sidebar glass-panel">
            <div class="sidebar-robot-list-section"> <!-- Robot listesi ve baÅŸlÄ±k iÃ§in yeni kapsayÄ±cÄ± -->
                <div class="sidebar-title-container">
                    <div class="sidebar-title" data-lang-key="activeRobotsTitle">
                        <span>ðŸ¤–</span>
                        Aktif Robotlar
                    </div>
                    <button class="sidebar-action-btn" id="addRobotBtn" onclick="addRobot()" data-lang-key="addRobotBtn" title="Yeni Robot Ekle">âž•</button>
                    
                    <button class="sidebar-action-btn" id="deleteRobotBtn" onclick="deleteSelectedRobot()" data-lang-key="deleteRobotBtn" title="SeÃ§ili Robotu Sil">âž–</button>
                </div>
                
                <div id="robotListContainer">
                    <!-- Robot Ã¶ÄŸeleri JavaScript tarafÄ±ndan dinamik olarak yÃ¼klenecek -->
                </div>
            </div>

            <div class="quick-actions-section"> <!-- HÄ±zlÄ± Ä°ÅŸlemler kÄ±smÄ± kartÄ±n en altÄ±na gelecek -->
                <div class="sidebar-title" data-lang-key="quickActionsTitle">
                    <span>âš™ï¸</span>
                    HÄ±zlÄ± Ä°ÅŸlemler
                </div>
                <button class="control-btn" style="width: 100%; margin-bottom: 0.5rem;" data-lang-key="goHomeBtn">ðŸ  Hepsini Eve GÃ¶nder</button>
                <button class="control-btn" style="width: 100%; margin-bottom: 0.5rem;" data-lang-key="emergencyStopBtn">â¸ï¸ Acil Durdurma</button>
                <button class="control-btn" style="width: 100%;" data-lang-key="refreshStatusBtn">ðŸ”„ Durumu Yenile</button>
                <button class="control-btn" style="width: 100%; margin-top: 1rem;" onclick="analyzeRobotStatus()" data-lang-key="analyzeStatusBtn">âœ¨ Robot Durumu Analizi</button>
            </div>
        </div>

        <!-- Merkez - Harita Konteyneri -->
        <div class="map-container glass-panel">
            <div class="map-header">
                <div class="map-title" data-lang-key="liveMapTitle">ðŸ—ºï¸ CanlÄ± Harita GÃ¶rÃ¼nÃ¼mÃ¼</div>
                <div class="map-controls">
                    <button class="control-btn" data-lang-key="centerBtn">ðŸ“ Merkezle</button>
                    <button class="control-btn" data-lang-key="zoomInBtn">ðŸ” YakÄ±nlaÅŸtÄ±r</button>
                    <button class="control-btn" data-lang-key="zoomOutBtn">ðŸ”Ž UzaklaÅŸtÄ±r</button>
                    <button class="control-btn" data-lang-key="followRobotBtn">ðŸŽ¯ Robotu Takip Et</button>
                </div>
            </div>
            
            <div class="map-canvas" id="mapCanvas">
                <svg width="100%" height="100%" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid meet" class="robot-map-svg">
                    <defs>
                        <!-- Izgara desenleri -->
                        <pattern id="smallGrid" width="20" height="20" patternUnits="userSpaceOnUse">
                            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="0.5"/>
                        </pattern>
                        <pattern id="darkGrid" width="20" height="20" patternUnits="userSpaceOnUse">
                            <path d="M 20 0 L 0 0 0 20" fill="none" stroke="rgba(55, 65, 81, 0.5)" stroke-width="0.5"/>
                        </pattern>
                        <!-- Ok baÅŸÄ± iÅŸaretÃ§isi -->
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#667eea" />
                        </marker>
                    </defs>

                    <!-- Arka plan Ä±zgara Ã§izgileri -->
                    <rect width="100%" height="100%" class="svg-grid-bg"/>

                    <!-- Robot YollarÄ± (dinamik yollar iÃ§in yer tutucu) -->
                    <path id="robotPath1" d="M100 100 C 200 0, 300 200, 400 100 S 600 0, 700 100" fill="none" stroke="#22c55e" stroke-width="3" stroke-dasharray="10 5" marker-end="url(#arrowhead)"/>
                    <path id="robotPath2" d="M150 500 Q 300 400 450 500 T 700 400" fill="none" stroke="#60a5fa" stroke-width="3" stroke-dasharray="5 5" marker-end="url(#arrowhead)"/>

                    <!-- Engeller/Duvarlar -->
                    <rect x="50" y="250" width="100" height="80" rx="10" ry="10" fill="rgba(255,255,255,0.3)" stroke="rgba(255,255,255,0.5)" stroke-width="1"/>
                    <circle cx="650" cy="200" r="40" fill="rgba(255,255,255,0.3)" stroke="rgba(255,255,255,0.5)" stroke-width="1"/>
                    <polygon points="300,400 350,300 400,400 350,500" fill="rgba(255,255,255,0.3)" stroke="rgba(255,255,255,0.5)" stroke-width="1"/>

                    <!-- Åžarj Ä°stasyonlarÄ± -->
                    <rect x="700" y="50" width="80" height="40" rx="5" ry="5" fill="#f59e0b" stroke="#d97706" stroke-width="2"/>
                    <text x="740" y="75" text-anchor="middle" font-size="20" fill="white">âš¡</text>
                </svg>
                <!-- Robot Ä°ÅŸaretÃ§ileri - KonumlarÄ± JS ile ayarlanacak -->
                <!-- Robot markerlarÄ±n harita Ã¼zerinde gÃ¶rÃ¼nmesi iÃ§in z-index 2 verildi -->
                <!-- JavaScript tarafÄ±ndan dinamik olarak yÃ¼klenecek -->
            </div>
        </div>

        <!-- SaÄŸ Kenar Ã‡ubuÄŸu - Durum KartlarÄ± -->
        <div class="right-sidebar" id="rightSidebar">
            <!-- Batarya KartÄ± -->
            <div class="status-card" draggable="true" id="card-battery">
                <div class="card-header">
                    <div class="card-icon battery-icon">ðŸ”‹</div>
                    <div class="card-title" data-lang-key="batteryStatusTitle">Batarya Durumu</div>
                </div>
                <div class="card-value" id="batteryLevel">87%</div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: 87%;" id="batteryProgress"></div>
                </div>
                <div class="card-details">
                    <span data-lang-key="voltageLabel">Voltaj: <span id="voltage">24.3V</span></span>
                    <span data-lang-key="currentLabel">AkÄ±m: <span id="current">-2.1A</span></span>
                </div>
                <div class="chart-container">
                    <canvas id="batteryChart"></canvas>
                </div>
            </div>

            <!-- Konum KartÄ± -->
            <div class="status-card" draggable="true" id="card-location">
                <div class="card-header">
                    <div class="card-icon location-icon">ðŸ“</div>
                    <div class="card-title" data-lang-key="locationTitle">Konum</div>
                </div>
                <div class="card-details" style="margin-bottom: 1rem;">
                    <div data-lang-key="xLabel">X: <span id="posX">12.34</span>m</div>
                    <div data-lang-key="yLabel">Y: <span id="posY">-5.67</span>m</div>
                    <div data-lang-key="thetaLabel">Î¸: <span id="posTheta">45.2Â°</span></div>
                </div>
            </div>

            <!-- HÄ±z KartÄ± -->
            <div class="status-card" draggable="true" id="card-speed">
                <div class="card-header">
                    <div class="card-icon speed-icon">ðŸš€</div>
                    <div class="card-title" data-lang-key="speedTitle">HÄ±z</div>
                </div>
                <div class="card-value" id="linearSpeed">1.2 m/s</div>
                <div class="card-details">
                    <span data-lang-key="linearLabel">DoÄŸrusal: <span id="linearVel">1.2</span> m/s</span>
                    <span data-lang-key="angularLabel">AÃ§Ä±sal: <span id="angularVel">0.3</span> rad/s</span>
                </div>
            </div>

            <!-- SÄ±caklÄ±k KartÄ± -->
            <div class="status-card" draggable="true" id="card-temperature">
                <div class="card-header">
                    <div class="card-icon temp-icon">ðŸŒ¡ï¸</div>
                    <div class="card-title" data-lang-key="temperatureTitle">SÄ±caklÄ±k</div>
                </div>
                <div class="card-value" id="temperature">42Â°C</div>
                <div class="card-details">
                    <span data-lang-key="cpuTempLabel">CPU: <span id="cpuTemp">38Â°C</span></span>
                    <span data-lang-key="gpuTempLabel">GPU: <span id="gpuTemp">45Â°C</span></span>
                </div>
            </div>

            <!-- Sistem Durumu KartÄ± -->
            <div class="status-card" draggable="true" id="card-system">
                <div class="card-header">
                    <div class="card-icon" style="background: linear-gradient(45deg, #8b5cf6, #7c3aed); color: white;">ðŸ’»</div>
                    <div class="card-title" data-lang-key="systemStatusTitle">Sistem Durumu</div>
                </div>
                <div class="card-details" style="flex-direction: column; gap: 0.5rem;">
                    <div style="display: flex; justify-content: space-between;">
                        <span data-lang-key="cpuUsageLabel">CPU KullanÄ±mÄ±:</span>
                        <span id="cpuUsage">23%</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span data-lang-key="memoryLabel">Bellek:</span>
                        <span id="memUsage">2.1/8.0 GB</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span id="uptimeLabel" data-lang-key="uptimeLabel">Ã‡alÄ±ÅŸma SÃ¼resi:</span>
                        <span id="uptime">2sa 34dk</span>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="cpuUsageChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Kamera AkÄ±ÅŸÄ± Konteyneri (haritanÄ±n altÄ±nda ayrÄ± bir alan) -->
        <div class="camera-container glass-panel">
            <div class="camera-header">
                <div class="camera-title" data-lang-key="cameraStreamsTitle">ðŸ“¹ Kamera AkÄ±ÅŸlarÄ±</div>
                <div class="camera-controls">
                    <select class="camera-select" id="cameraLayout">
                        <option value="grid" data-lang-key="gridLayout">Izgara GÃ¶rÃ¼nÃ¼mÃ¼</option>
                        <option value="single" data-lang-key="singleLayout">Tekli GÃ¶rÃ¼nÃ¼m</option>
                        <option value="pip" data-lang-key="pipLayout">Resim Ä°Ã§inde Resim</option>
                    </select>
                    <button class="camera-btn" onclick="toggleRecording()">
                        <span id="recordBtn" data-lang-key="recordBtn">ðŸ”´ Kaydet</span>
                    </button>
                    <button class="camera-btn" onclick="takeSnapshot()" data-lang-key="snapshotBtn">ðŸ“¸ AnlÄ±k GÃ¶rÃ¼ntÃ¼</button>
                    <button class="camera-btn" onclick="refreshStreams()" data-lang-key="refreshStreamsBtn">ðŸ”„ Yenile</button>
                </div>
            </div>
            
            <div class="camera-grid" id="cameraGrid">
                <!-- Ã–n Kamera -->
                <div class="camera-stream active" data-camera="front">
                    <div class="stream-header">
                        <div>
                            <span data-lang-key="frontCamTitle">Ã–n Kamera</span>
                            <div class="stream-status">
                                <div class="stream-indicator live"></div>
                                <span data-lang-key="liveStatus">CANLI</span>
                            </div>
                        </div>
                        <span>1920x1080 â€¢ 30fps</span>
                    </div>
                    <video class="stream-video" autoplay muted playsinline>
                        <source src="#" type="video/webm">
                    </video>
                    <div class="stream-placeholder">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ“¹</div>
                        <div data-lang-key="frontCamPlaceholder">Ã–n Kamera AkÄ±ÅŸÄ±</div>
                        <div style="font-size: 0.8rem; margin-top: 0.5rem;" data-lang-key="connectingStatus">BaÄŸlanÄ±lÄ±yor...</div>
                    </div>
                    <button class="snapshot-btn" onclick="takeSnapshot('front')">ðŸ“¸</button>
                    <button class="fullscreen-btn" onclick="openFullscreen('front')">â›¶</button>
                    <div class="stream-overlay">
                        <span data-lang-key="fpsLabel">FPS: <span id="fps-front">30</span></span>
                        <span data-lang-key="qualityLabel">Kalite: <span id="quality-front">HD</span></span>
                    </div>
                </div>

                <!-- Arka Kamera -->
                <div class="camera-stream" data-camera="rear">
                    <div class="stream-header">
                        <div>
                            <span data-lang-key="rearCamTitle">Arka Kamera</span>
                            <div class="stream-status">
                                <div class="stream-indicator live"></div>
                                <span data-lang-key="liveStatus">CANLI</span>
                            </div>
                        </div>
                        <span>1280x720 â€¢ 24fps</span>
                    </div>
                    <video class="stream-video" autoplay muted playsinline>
                        <source src="#" type="video/webm">
                    </video>
                    <div class="stream-placeholder">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ“¹</div>
                        <div data-lang-key="rearCamPlaceholder">Arka Kamera AkÄ±ÅŸÄ±</div>
                        <div style="font-size: 0.8rem; margin-top: 0.5rem;" data-lang-key="connectingStatus">BaÄŸlanÄ±yor...</div>
                    </div>
                    <button class="snapshot-btn" onclick="takeSnapshot('rear')">ðŸ“¸</button>
                    <button class="fullscreen-btn" onclick="openFullscreen('rear')">â›¶</button>
                    <div class="stream-overlay">
                        <span data-lang-key="fpsLabel">FPS: <span id="fps-rear">24</span></span>
                        <span data-lang-key="qualityLabel">Kalite: <span id="quality-rear">720p</span></span>
                    </div>
                </div>

                <!-- Yan Kamera -->
                <div class="camera-stream" data-camera="side">
                    <div class="stream-header">
                        <div>
                            <span data-lang-key="sideCamTitle">Yan Kamera</span>
                            <div class="stream-status">
                                <div class="stream-indicator"></div>
                                <span data-lang-key="offlineStatus">Ã‡EVRÄ°MDÄ°DIÅžI</span>
                            </div>
                        </div>
                        <span>640x480 â€¢ 15fps</span>
                    </div>
                    <video class="stream-video" autoplay muted playsinline>
                        <source src="#" type="video/webm">
                    </video>
                    <div class="stream-placeholder">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ“¹</div>
                        <div data-lang-key="sideCamPlaceholder">Yan Kamera AkÄ±ÅŸÄ±</div>
                        <div style="font-size: 0.8rem; margin-top: 0.5rem;" data-lang-key="camOfflineStatus">Kamera Ã‡evrimdÄ±ÅŸÄ±</div>
                    </div>
                    <button class="snapshot-btn" onclick="takeSnapshot('side')">ðŸ“¸</button>
                    <button class="fullscreen-btn" onclick="openFullscreen('side')">â›¶</button>
                    <div class="stream-overlay">
                        <span data-lang-key="fpsLabel">FPS: <span id="fps-side">0</span></span>
                        <span data-lang-key="qualityLabel">Kalite: <span id="quality-side">--</span></span>
                    </div>
                </div>

                <!-- Derinlik KamerasÄ± -->
                <div class="camera-stream" data-camera="depth">
                    <div class="stream-header">
                        <div>
                            <span data-lang-key="depthCamTitle">Derinlik KamerasÄ±</span>
                            <div class="stream-status">
                                <div class="stream-indicator live"></div>
                                <span data-lang-key="liveStatus">CANLI</span>
                            </div>
                        </div>
                        <span>640x480 â€¢ 30fps</span>
                    </div>
                    <video class="stream-video" autoplay muted playsinline>
                        <source src="#" type="video/webm">
                    </video>
                    <div class="stream-placeholder">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸŽ­</div>
                        <div data-lang-key="depthCamPlaceholder">Derinlik Kamera AkÄ±ÅŸÄ±</div>
                        <div style="font-size: 0.8rem; margin-top: 0.5rem;" data-lang-key="depthProcessingStatus">Derinlik verisi iÅŸleniyor...</div>
                    </div>
                    <button class="snapshot-btn" onclick="takeSnapshot('depth')">ðŸ“¸</button>
                    <button class="fullscreen-btn" onclick="openFullscreen('depth')">â›¶</button>
                    <div class="stream-overlay">
                        <span data-lang-key="fpsLabel">FPS: <span id="fps-depth">30</span></span>
                        <span data-lang-key="rangeLabel">Menzil: <span id="range-depth">0.3-10m</span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tam Ekran ModalÄ± -->
    <div class="fullscreen-modal" id="fullscreenModal">
        <video class="fullscreen-video" id="fullscreenVideo" autoplay muted playsinline></video>
        <button class="close-fullscreen" onclick="closeFullscreen()">Ã—</button>
    </div>

    <!-- Robot Durumu Analiz ModalÄ± -->
    <div class="analysis-modal-overlay" id="analysisModalOverlay">
        <div class="analysis-modal-content">
            <button class="analysis-modal-close-btn" onclick="closeAnalysisModal()">Ã—</button>
            <h2 class="analysis-modal-title" data-lang-key="analysisModalTitle">âœ¨ Robot Durumu Analizi</h2>
            <div class="analysis-loading-spinner" id="analysisSpinner"></div>
            <div class="analysis-modal-body" id="analysisResult">
                <!-- Analiz sonucu buraya yÃ¼klenecek -->
            </div>
        </div>
    </div>

    <script>
        // Kamera AkÄ±ÅŸÄ± YÃ¶netimi
        let isRecording = false;
        let activeCamera = 'front';
        let streams = {
            front: { active: true, fps: 30, quality: 'HD' },
            rear: { active: true, fps: 24, quality: '720p', streamUrl: 'https://example.com/rear_stream.webm' },
            side: { active: false, fps: 0, quality: '--' },
            depth: { active: true, fps: 30, quality: 'Depth' }
        };

        // Dil YÃ¶netimi Ä°Ã§in Ã‡eviriler
        const translations = {
            en: {
                dashboardTitle: 'RobotFlow Dashboard',
                navDashboard: 'Dashboard',
                navMaps: 'Maps',
                navAnalytics: 'Analytics',
                navSettings: 'Settings',
                activeRobotsTitle: 'Active Robots',
                addRobotBtn: 'Add New Robot',
                deleteRobotBtn: 'Delete Selected Robot',
                quickActionsTitle: 'Quick Actions',
                goHomeBtn: 'ðŸ  Send All Home',
                emergencyStopBtn: 'â¸ï¸ Emergency Stop',
                refreshStatusBtn: 'ðŸ”„ Refresh Status',
                analyzeStatusBtn: 'âœ¨ Analyze Robot Status',
                onlineStatus: 'Online â€¢ Autonomous',
                warningStatus: 'Warning â€¢ Low Battery',
                offlineStatus: 'Offline â€¢ Maintenance',
                liveMapTitle: 'ðŸ—ºï¸ Live Map View',
                centerBtn: 'ðŸ“ Center',
                zoomInBtn: 'ðŸ” Zoom In',
                zoomOutBtn: 'ðŸ”Ž Zoom Out',
                followRobotBtn: 'ðŸŽ¯ Follow Robot',
                batteryStatusTitle: 'Battery Status',
                voltageLabel: 'Voltage:',
                currentLabel: 'Current:',
                locationTitle: 'Location',
                xLabel: 'X:',
                yLabel: 'Y:',
                thetaLabel: 'Î¸:',
                speedTitle: 'Speed',
                linearLabel: 'Linear:',
                angularLabel: 'Angular:',
                temperatureTitle: 'Temperature',
                cpuTempLabel: 'CPU:',
                gpuTempLabel: 'GPU:',
                systemStatusTitle: 'System Status',
                cpuUsageLabel: 'CPU Usage:',
                memoryLabel: 'Memory:',
                uptimeLabel: 'Uptime:',
                cameraStreamsTitle: 'ðŸ“¹ Camera Streams',
                gridLayout: 'Grid View',
                singleLayout: 'Single View',
                pipLayout: 'Picture-in-Picture',
                recordBtn: 'ðŸ”´ Record',
                stopRecordBtn: 'â¹ï¸ Stop',
                snapshotBtn: 'ðŸ“¸ Snapshot',
                refreshStreamsBtn: 'ðŸ”„ Refresh',
                frontCamTitle: 'Front Camera',
                rearCamTitle: 'Rear Camera',
                sideCamTitle: 'Side Camera',
                depthCamTitle: 'Depth Camera',
                liveStatus: 'LIVE',
                offlineStatus: 'OFFLINE',
                connectingStatus: 'Connecting...',
                camOfflineStatus: 'Camera Offline',
                depthProcessingStatus: 'Processing depth data...',
                fpsLabel: 'FPS:',
                qualityLabel: 'Quality:',
                rangeLabel: 'Range:',
                notificationSnapshot: (camera) => `Snapshot taken from ${camera} camera`,
                notificationRecordingStarted: 'Recording started',
                notificationRecordingStopped: 'Recording stopped',
                notificationRefreshStreams: 'Refreshing camera streams...',
                notificationFullscreen: (camera) => `Fullscreen: ${camera} camera`,
                notificationNoRobotToDelete: 'No robot to delete.',
                notificationRobotAdded: (name) => `'${name}' robot added.`,
                notificationRobotDeleted: (name) => `'${name}' robot deleted.`,
                notificationLayoutChanged: (layout) => `Layout changed to ${layout} view`,
                notificationNoRobotForAnalysis: 'Please select a robot to analyze.',
                analysisModalTitle: 'âœ¨ Robot Status Analysis',
                analysisErrorApi: 'Could not get analysis. Please try again later.',
                analysisErrorNetwork: 'An error occurred during analysis. Please check your network connection or try again.',
                onlineDotStatus: 'Online â€¢ Autonomous',
                warningDotStatus: 'Warning â€¢ Low Battery',
                offlineDotStatus: 'Offline â€¢ Maintenance',
            },
            tr: {
                dashboardTitle: 'RobotFlow Kontrol Paneli',
                navDashboard: 'Kontrol Paneli',
                navMaps: 'Haritalar',
                navAnalytics: 'Analizler',
                navSettings: 'Ayarlar',
                activeRobotsTitle: 'Aktif Robotlar',
                addRobotBtn: 'Yeni Robot Ekle',
                deleteRobotBtn: 'SeÃ§ili Robotu Sil',
                quickActionsTitle: 'HÄ±zlÄ± Ä°ÅŸlemler',
                goHomeBtn: 'ðŸ  Hepsini Eve GÃ¶nder',
                emergencyStopBtn: 'â¸ï¸ Acil Durdurma',
                refreshStatusBtn: 'ðŸ”„ Durumu Yenile',
                analyzeStatusBtn: 'âœ¨ Robot Durumu Analizi',
                onlineStatus: 'Ã‡evrimiÃ§i â€¢ Otonom',
                warningStatus: 'UyarÄ± â€¢ DÃ¼ÅŸÃ¼k Batarya',
                offlineStatus: 'Ã‡evrimdÄ±ÅŸÄ± â€¢ BakÄ±m',
                liveMapTitle: 'ðŸ—ºï¸ CanlÄ± Harita GÃ¶rÃ¼nÃ¼mÃ¼',
                centerBtn: 'ðŸ“ Merkezle',
                zoomInBtn: 'ðŸ” YakÄ±nlaÅŸtÄ±r',
                zoomOutBtn: 'ðŸ”Ž UzaklaÅŸtÄ±r',
                followRobotBtn: 'ðŸŽ¯ Robotu Takip Et',
                batteryStatusTitle: 'Batarya Durumu',
                voltageLabel: 'Voltaj:',
                currentLabel: 'AkÄ±m:',
                locationTitle: 'Konum',
                xLabel: 'X:',
                yLabel: 'Y:',
                thetaLabel: 'Î¸:',
                speedTitle: 'HÄ±z',
                linearLabel: 'DoÄŸrusal:',
                angularLabel: 'AÃ§Ä±sal:',
                temperatureTitle: 'SÄ±caklÄ±k',
                cpuTempLabel: 'CPU:',
                gpuTempLabel: 'GPU:',
                systemStatusTitle: 'Sistem Durumu',
                cpuUsageLabel: 'CPU KullanÄ±mÄ±:',
                memoryLabel: 'Bellek:',
                uptimeLabel: 'Ã‡alÄ±ÅŸma SÃ¼resi:',
                cameraStreamsTitle: 'ðŸ“¹ Kamera AkÄ±ÅŸlarÄ±',
                gridLayout: 'Izgara GÃ¶rÃ¼nÃ¼mÃ¼',
                singleLayout: 'Tekli GÃ¶rÃ¼nÃ¼m',
                pipLayout: 'Resim Ä°Ã§inde Resim',
                recordBtn: 'ðŸ”´ Kaydet',
                stopRecordBtn: 'â¹ï¸ Durdur',
                snapshotBtn: 'ðŸ“¸ AnlÄ±k GÃ¶rÃ¼ntÃ¼',
                refreshStreamsBtn: 'ðŸ”„ Yenile',
                frontCamTitle: 'Ã–n Kamera',
                rearCamTitle: 'Arka Kamera',
                sideCamTitle: 'Yan Kamera',
                depthCamTitle: 'Derinlik KamerasÄ±',
                liveStatus: 'CANLI',
                offlineStatus: 'Ã‡EVRÄ°MDÄ°DIÅžI',
                connectingStatus: 'BaÄŸlanÄ±yor...',
                camOfflineStatus: 'Kamera Ã‡evrimdÄ±ÅŸÄ±',
                depthProcessingStatus: 'Derinlik verisi iÅŸleniyor...',
                fpsLabel: 'FPS:',
                qualityLabel: 'Kalite:',
                rangeLabel: 'Menzil:',
                notificationSnapshot: (camera) => `${camera} kamerasÄ±ndan anlÄ±k gÃ¶rÃ¼ntÃ¼ alÄ±ndÄ±`,
                notificationRecordingStarted: 'KayÄ±t baÅŸlatÄ±ldÄ±',
                notificationRecordingStopped: 'KayÄ±t durduruldu',
                notificationRefreshStreams: 'Kamera akÄ±ÅŸlarÄ± yenileniyor...',
                notificationFullscreen: (camera) => `Tam Ekran: ${camera} kamera`,
                notificationNoRobotToDelete: 'Silinecek robot yok.',
                notificationRobotAdded: (name) => `'${name}' robotu eklendi.`,
                notificationRobotDeleted: (name) => `'${name}' robotu silindi.`,
                notificationLayoutChanged: (layout) => `DÃ¼zen ${layout} gÃ¶rÃ¼nÃ¼mÃ¼ne deÄŸiÅŸtirildi`,
                notificationNoRobotForAnalysis: 'LÃ¼tfen analiz edilecek bir robot seÃ§in.',
                analysisModalTitle: 'âœ¨ Robot Durumu Analizi',
                analysisErrorApi: 'Analiz alÄ±namadÄ±. LÃ¼tfen daha sonra tekrar deneyin.',
                analysisErrorNetwork: 'Analiz sÄ±rasÄ±nda bir hata oluÅŸtu. LÃ¼tfen aÄŸ baÄŸlantÄ±nÄ±zÄ± kontrol edin veya tekrar deneyin.',
                onlineDotStatus: 'Ã‡evrimiÃ§i â€¢ Otonom',
                warningDotStatus: 'UyarÄ± â€¢ DÃ¼ÅŸÃ¼k Batarya',
                offlineDotStatus: 'Ã‡evrimdÄ±ÅŸÄ± â€¢ BakÄ±m',
            }
        };

        let currentLanguage = 'tr'; // VarsayÄ±lan dil TÃ¼rkÃ§e

        /**
         * Belirtilen dile geÃ§iÅŸ yapar ve tÃ¼m UI metinlerini gÃ¼nceller.
         * SeÃ§ilen dili yerel depolamaya kaydeder.
         * @param {string} langCode - GeÃ§ilecek dilin kodu (Ã¶rn. 'en', 'tr').
         */
        function switchLanguage(langCode) {
            currentLanguage = langCode;
            localStorage.setItem('language', langCode);
            applyTranslations();
            updateRobotList(); // Robot listesi durum metinleri iÃ§in yeniden Ã§izilmeli
            updateChartThemes(); // Chart etiketleri iÃ§in grafikler gÃ¼ncellenmeli
        }

        /**
         * HTML iÃ§inde `data-lang-key` Ã¶zniteliÄŸine sahip tÃ¼m Ã¶ÄŸelerin metin iÃ§eriÄŸini
         * mevcut dile gÃ¶re gÃ¼nceller.
         */
        function applyTranslations() {
            // Dashboard baÅŸlÄ±ÄŸÄ±nÄ± gÃ¼ncelle
            const dashboardTitleElement = document.getElementById('dashboardTitle');
            if (dashboardTitleElement) {
                dashboardTitleElement.textContent = translations[currentLanguage].dashboardTitle;
            }
            
            // data-lang-key Ã¶zniteliÄŸine sahip tÃ¼m Ã¶ÄŸeleri gÃ¼ncelle
            document.querySelectorAll('[data-lang-key]').forEach(element => {
                const key = element.getAttribute('data-lang-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    // Ã–zellikle `addRobotBtn` ve `deleteRobotBtn` iÃ§in `title` Ã¶zniteliÄŸini gÃ¼ncelle
                    if (key === 'addRobotBtn' || key === 'deleteRobotBtn') {
                        if (element.tagName === 'BUTTON') { // Sadece button elementleri iÃ§in title gÃ¼ncelle
                            element.title = translations[currentLanguage][key];
                        }
                        // TextContent'i de gÃ¼ncellemek gerekiyorsa:
                        // element.textContent = translations[currentLanguage][key]; 
                    } else if (key === 'recordBtn') { // Kaydet/Durdur butonu iÃ§in Ã¶zel durum
                         const recordBtnElement = document.getElementById('recordBtn');
                         if (recordBtnElement) {
                             if (isRecording) {
                                 recordBtnElement.textContent = translations[currentLanguage].stopRecordBtn;
                             } else {
                                 recordBtnElement.textContent = translations[currentLanguage].recordBtn;
                             }
                         }
                    }
                    else {
                        element.textContent = translations[currentLanguage][key];
                    }
                }
            });


            // Select option'larÄ±nÄ± gÃ¼ncelle
            document.querySelectorAll('#cameraLayout option').forEach(option => {
                const key = option.getAttribute('data-lang-key');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    option.textContent = translations[currentLanguage][key];
                }
            });

            // Record/Stop butonu metnini gÃ¼ncelleyin
            // Bu kÄ±sÄ±m yukarÄ±daki genel dÃ¶ngÃ¼ye taÅŸÄ±ndÄ±, ancak doÄŸrudan eriÅŸim iÃ§in hala kullanÄ±labilir.
            // const recordBtnElement = document.getElementById('recordBtn');
            // if (recordBtnElement) {
            //     if (isRecording) {
            //         recordBtnElement.textContent = translations[currentLanguage].stopRecordBtn;
            //     } else {
            //         recordBtnElement.textContent = translations[currentLanguage].recordBtn;
            //     }
            // }

            // Kamera placeholder metinlerini gÃ¼ncelle
            const cameraPlaceholders = [
                { id: 'frontCamPlaceholder', statusId: 'connectingStatus' },
                { id: 'rearCamPlaceholder', statusId: 'connectingStatus' },
                { id: 'sideCamPlaceholder', statusId: 'camOfflineStatus' },
                { id: 'depthCamPlaceholder', statusId: 'depthProcessingStatus' }
            ];

            document.querySelectorAll('.camera-stream').forEach((stream, index) => {
                const placeholderDiv = stream.querySelector('.stream-placeholder');
                if (placeholderDiv) {
                    const mainTextDiv = placeholderDiv.children[1]; // Ä°kinci Ã§ocuk ana metin
                    const statusTextDiv = placeholderDiv.children[2]; // ÃœÃ§Ã¼ncÃ¼ Ã§ocuk durum metni

                    if (mainTextDiv) {
                        const camTitleKey = `${stream.dataset.camera}CamPlaceholder`;
                        mainTextDiv.textContent = translations[currentLanguage][camTitleKey];
                    }
                    if (statusTextDiv) {
                        const statusKey = cameraPlaceholders[index].statusId;
                        statusTextDiv.textContent = translations[currentLanguage][statusKey];
                    }
                }
            });
        }


        /**
         * TemayÄ± yerel depolama veya sistem tercihine gÃ¶re baÅŸlatÄ±r.
         * AyrÄ±ca dil ayarÄ±nÄ± da baÅŸlatÄ±r.
         */
        function initSettings() {
            // Tema baÅŸlangÄ±cÄ±
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
                document.body.classList.add('dark-theme');
            }

            // Dil baÅŸlangÄ±cÄ±
            const savedLang = localStorage.getItem('language');
            const browserLang = navigator.language.split('-')[0]; // Sadece 'en' veya 'tr' gibi ana dili al
            let initialLang = 'en'; // VarsayÄ±lan olarak Ä°ngilizce

            if (savedLang && translations[savedLang]) {
                initialLang = savedLang;
            } else if (translations[browserLang]) {
                initialLang = browserLang;
            }

            currentLanguage = initialLang;
            const langSelect = document.getElementById('languageSelect');
            if (langSelect) { // langSelect'in var olup olmadÄ±ÄŸÄ±nÄ± kontrol et
                langSelect.value = initialLang;
            }
            applyTranslations(); // UygulamayÄ± baÅŸlatÄ±rken Ã§evirileri uygula
            updateChartThemes(); // Grafik temalarÄ±nÄ± ayarla
        }

        /**
         * KayÄ±t durumunu deÄŸiÅŸtirir ve UI'yÄ± buna gÃ¶re gÃ¼nceller.
         * KayÄ±t durumu deÄŸiÅŸikliÄŸi hakkÄ±nda bir bildirim gÃ¶sterir.
         */
        function toggleRecording() {
            isRecording = !isRecording;
            const btn = document.getElementById('recordBtn');
            if (btn) { // Null kontrolÃ¼ eklendi
                if (isRecording) {
                    btn.textContent = translations[currentLanguage].stopRecordBtn;
                    btn.parentElement.style.background = '#ef4444';
                    showNotification(translations[currentLanguage].notificationRecordingStarted, 'success');
                } else {
                    btn.textContent = translations[currentLanguage].recordBtn;
                    btn.parentElement.style.background = '#667eea';
                    showNotification(translations[currentLanguage].notificationRecordingStopped, 'info');
                }
            }
        }

        /**
         * Belirtilen kameradan veya aktif kameradan anlÄ±k gÃ¶rÃ¼ntÃ¼ alÄ±r.
         * Kamera Ã¶ÄŸesi Ã¼zerinde bir flaÅŸ efekti simÃ¼le eder ve bir mesaj kaydeder.
         * @param {string} [camera=null] - AnlÄ±k gÃ¶rÃ¼ntÃ¼ alÄ±nacak kameranÄ±n ID'si (Ã¶rn. 'front', 'rear').
         * Null ise, ÅŸu an aktif olan kameradan anlÄ±k gÃ¶rÃ¼ntÃ¼ alÄ±nÄ±r.
         */
        function takeSnapshot(camera = null) {
            const targetCamera = camera || activeCamera;
            showNotification(translations[currentLanguage].notificationSnapshot(targetCamera), 'success');
            
            // Kamera Ã¶ÄŸesi Ã¼zerinde flaÅŸ efekti simÃ¼le et
            const cameraElement = document.querySelector(`[data-camera="${targetCamera}"]`);
            if (cameraElement) {
                cameraElement.style.filter = 'brightness(2)';
                setTimeout(() => {
                    cameraElement.style.filter = '';
                }, 200);
            }
            
            console.log(`AnlÄ±k gÃ¶rÃ¼ntÃ¼ alÄ±ndÄ±: ${targetCamera}_${Date.now()}.jpg`);
        }

        /**
         * TÃ¼m kamera akÄ±ÅŸlarÄ±nÄ± yeniler.
         * Yeniden baÄŸlanma sÃ¼recini simÃ¼le eder ve yer tutucularÄ± gÃ¼nceller.
         */
        function refreshStreams() {
            showNotification(translations[currentLanguage].notificationRefreshStreams, 'info');
            
            // Yeniden baÄŸlanma mesajÄ±nÄ± gÃ¶stererek akÄ±ÅŸ yenilemeyi simÃ¼le et
            document.querySelectorAll('.stream-placeholder').forEach(placeholder => {
                if (placeholder) { // Null kontrolÃ¼ eklendi
                    placeholder.innerHTML = `
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ðŸ”„</div>
                        <div>${translations[currentLanguage].connectingStatus}</div>
                    `;
                }
            });
            
            // Bir gecikmeden sonra orijinal yer tutucu mesajlarÄ±na geri dÃ¶n
            setTimeout(() => {
                applyTranslations(); // Yer tutucu metinlerini orijinal haline getir
            }, 2000);
        }

        /**
         * Belirtilen kamera akÄ±ÅŸÄ± iÃ§in tam ekran modalÄ±nÄ± aÃ§ar.
         * GerÃ§ek bir uygulamada, bu, gerÃ§ek video akÄ±ÅŸÄ±nÄ± yÃ¼kleyecektir.
         * @param {string} camera - Tam ekranda gÃ¶rÃ¼ntÃ¼lenecek kamera akÄ±ÅŸÄ±nÄ±n ID'si.
         */
        function openFullscreen(camera) {
            activeCamera = camera;
            const modal = document.getElementById('fullscreenModal');
            const video = document.getElementById('fullscreenVideo');
            
            if (modal) { // Null kontrolÃ¼ eklendi
                // GerÃ§ek bir uygulamada, video kaynaÄŸÄ±nÄ± burada ayarlarsÄ±nÄ±z:
                // video.src = streams[camera].streamUrl || '';
                
                modal.classList.add('show');
                showNotification(translations[currentLanguage].notificationFullscreen(camera), 'info');
            }
        }

        /**
         * Tam ekran modalÄ±nÄ± kapatÄ±r.
         */
        function closeFullscreen() {
            const modal = document.getElementById('fullscreenModal');
            if (modal) { // Null kontrolÃ¼ eklendi
                modal.classList.remove('show');
            }
        }

        // Kamera dÃ¼zeni deÄŸiÅŸikliÄŸi iÃ§in olay dinleyici
        document.getElementById('cameraLayout').addEventListener('change', function() {
            const layout = this.value;
            const grid = document.getElementById('cameraGrid');
            
            if (grid) { // Null kontrolÃ¼ eklendi
                // SeÃ§ime gÃ¶re Ä±zgara dÃ¼zenini ayarla
                switch(layout) {
                    case 'single':
                        grid.style.gridTemplateColumns = '1fr';
                        // Etkin olmayan kameralarÄ± gizle, sadece ilkini gÃ¶ster
                        document.querySelectorAll('.camera-stream').forEach((stream, index) => {
                            if (stream) stream.style.display = index === 0 ? 'flex' : 'none'; // Dahili dÃ¼zeni korumak iÃ§in flex kullanÄ±n
                        });
                        break;
                    case 'pip':
                        grid.style.gridTemplateColumns = '2fr 1fr';
                        document.querySelectorAll('.camera-stream').forEach(stream => {
                            if (stream) stream.style.display = 'flex';
                        });
                        break;
                    default: // 'grid'
                        grid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(280px, 1fr));';
                        document.querySelectorAll('.camera-stream').forEach(stream => {
                            if (stream) stream.style.display = 'flex';
                        });
                }
                showNotification(translations[currentLanguage].notificationLayoutChanged(translations[currentLanguage][`${layout}Layout`]), 'info');
            }
        });

        // Kamera akÄ±ÅŸÄ±nÄ± etkinleÅŸtirmek iÃ§in tÄ±klama iÅŸleyici
        document.querySelectorAll('.camera-stream').forEach(stream => {
            stream.addEventListener('click', function(e) {
                // AkÄ±ÅŸÄ±n iÃ§indeki bir dÃ¼ÄŸmeye tÄ±klanÄ±rsa etkinleÅŸtirmeyi engelle
                if (e.target.closest('.snapshot-btn') || e.target.closest('.fullscreen-btn')) {
                    return;
                }
                document.querySelectorAll('.camera-stream').forEach(s => s.classList.remove('active'));
                this.classList.add('active');
                activeCamera = this.dataset.camera;
            });
        });

        /**
         * GeÃ§ici bir bildirim mesajÄ± gÃ¶rÃ¼ntÃ¼ler.
         * @param {string} message - GÃ¶rÃ¼ntÃ¼lenecek mesaj.
         * @param {string} [type='info'] - Bildirim tÃ¼rÃ¼ ('success', 'error', 'info', 'warning').
         */
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = 'notification'; // BaÅŸlangÄ±Ã§ta 'show' yok
            
            const colors = {
                success: '#22c55e',
                error: '#ef4444',
                info: '#667eea',
                warning: '#f59e0b'
            };
            
            notification.style.borderLeft = `4px solid ${colors[type]}`;
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <span style="font-size: 1.2rem;">${type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸'}</span>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Animasyon iÃ§in yeniden akÄ±ÅŸÄ± zorla
            void notification.offsetWidth; 
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300); // GeÃ§iÅŸten sonra kaldÄ±r
            }, 3000);
        }

        // GerÃ§ek zamanlÄ± kamera verisi gÃ¼ncellemelerini simÃ¼le et
        setInterval(() => {
            // Aktif akÄ±ÅŸlar iÃ§in FPS deÄŸerlerini gÃ¼ncelle
            Object.keys(streams).forEach(camera => {
                if (streams[camera].active) {
                    const fpsElement = document.getElementById(`fps-${camera}`);
                    if (fpsElement) { // Null kontrolÃ¼ eklendi
                        const baseFps = streams[camera].fps;
                        const variation = Math.floor(Math.random() * 4) - 2; // Â±2 fps varyasyonu
                        fpsElement.textContent = Math.max(1, baseFps + variation);
                    }
                }
            });
        }, 2000);

        // Kamera kontrolleri iÃ§in klavye kÄ±sayollarÄ±
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault(); // TarayÄ±cÄ± kaydetme iletiÅŸim kutusunu engelle
                        takeSnapshot();
                        break;
                    case 'r':
                        e.preventDefault(); // TarayÄ±cÄ± yenilemeyi engelle
                        toggleRecording();
                        break;
                    case 'f':
                        e.preventDefault(); // TarayÄ±cÄ± tam ekranÄ± engelle
                        openFullscreen(activeCamera);
                        break;
                }
            }
        });

        // Tema YÃ¶netimi
        /**
         * AÃ§Ä±k ve koyu temalar arasÄ±nda geÃ§iÅŸ yapar.
         * Tercihi yerel depolamaya kaydeder.
         */
        function toggleTheme() {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            updateChartThemes(); // Tema deÄŸiÅŸtiÄŸinde grafikleri gÃ¼ncelle
        }

        // Sistem temasÄ± deÄŸiÅŸikliklerini dinle ve Ã¶zel bir tercih kaydedilmemiÅŸse gÃ¼ncelle
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme')) {
                if (e.matches) {
                    document.body.classList.add('dark-theme');
                } else {
                    document.body.classList.remove('dark-theme');
                }
                updateChartThemes(); // Tema deÄŸiÅŸtiÄŸinde grafikleri gÃ¼ncelle
            }
        });

        // GÃ¶sterim iÃ§in mock veri
        const robots = {
            robot1: {
                name: 'Explorer-01',
                status: 'online',
                battery: 87,
                position: { x: 12.34, y: -5.67, theta: 45.2 }, // GerÃ§ek robot koordinatlarÄ±
                velocity: { linear: 1.2, angular: 0.3 },
                temperature: 42,
                system: { cpu: 23, memory: '2.1/8.0', uptime: '2sa 34dk' },
                mapCoordX: 200, // SVG viewBox koordinatlarÄ± (800x600)
                mapCoordY: 150
            },
            robot2: {
                name: 'Mapper-02',
                status: 'warning',
                battery: 23,
                position: { x: 8.91, y: 2.45, theta: -12.8 },
                velocity: { linear: 0.5, angular: 0.1 },
                temperature: 38,
                system: { cpu: 45, memory: '3.2/8.0', uptime: '1sa 12dk' },
                mapCoordX: 400,
                mapCoordY: 300
            },
            robot3: {
                name: 'Guard-03',
                status: 'offline',
                battery: 0,
                position: { x: 0, y: 0, theta: 0 },
                velocity: { linear: 0, angular: 0 },
                temperature: 25,
                system: { cpu: 0, memory: '0/8.0', uptime: '0sa 0dk' },
                mapCoordX: 600,
                mapCoordY: 200
            }
        };

        let selectedRobot = 'robot1'; // BaÅŸlangÄ±Ã§ta seÃ§ili robot

        /**
         * Robot listesini (HTML Ã¶ÄŸelerini) gÃ¼nceller.
         * Mevcut listeyi temizler ve 'robots' nesnesindeki verilere gÃ¶re yeniden oluÅŸturur.
         * AyrÄ±ca tÄ±klama olaylarÄ±nÄ± ve aktif durumu da ayarlar.
         */
        function updateRobotList() {
            const robotListContainer = document.getElementById('robotListContainer');
            if (!robotListContainer) return;

            robotListContainer.innerHTML = ''; // Mevcut listeyi temizle

            const robotKeys = Object.keys(robots);
            if (robotKeys.length === 0) {
                selectedRobot = null; // Robot kalmadÄ±ysa seÃ§imi kaldÄ±r
            } else if (!selectedRobot || !robots[selectedRobot]) {
                selectedRobot = robotKeys[0]; // EÄŸer seÃ§ili robot yoksa veya silindiyse ilkini seÃ§
            }

            for (const robotId of robotKeys) {
                const robot = robots[robotId];
                const robotItem = document.createElement('div');
                robotItem.classList.add('robot-item');
                if (robotId === selectedRobot) {
                    robotItem.classList.add('active');
                }
                robotItem.dataset.robot = robotId;

                let statusText = '';
                let statusClass = '';
                switch(robot.status) {
                    case 'online':
                        statusText = translations[currentLanguage].onlineDotStatus;
                        statusClass = ''; 
                        break;
                    case 'warning':
                        statusText = translations[currentLanguage].warningDotStatus;
                        statusClass = 'warning';
                        break;
                    case 'offline':
                        statusText = translations[currentLanguage].offlineDotStatus;
                        statusClass = 'offline';
                        break;
                }

                robotItem.innerHTML = `
                    <div class="robot-name">${robot.name}</div>
                    <div class="robot-status">
                        <div class="status-indicator ${statusClass}"></div>
                        <span>${statusText}</span>
                    </div>
                `;
                
                robotItem.addEventListener('click', function() {
                    document.querySelectorAll('.robot-item').forEach(r => r.classList.remove('active'));
                    this.classList.add('active');
                    selectedRobot = this.dataset.robot;
                    updateRobotData();
                    updateMarkerVisuals();
                });
                robotListContainer.appendChild(robotItem);
            }
            updateRobotData(); // Listeyi gÃ¼ncelledikten sonra robot verilerini gÃ¼ncelle
            updateMarkerVisuals(); // Ä°ÅŸaretÃ§ileri de gÃ¼ncelle
        }

        /**
         * Yeni bir mock robot ekler.
         * Rastgele bir isim ve baÅŸlangÄ±Ã§ durumu ile yeni bir robot oluÅŸturur
         * ve 'robots' nesnesine ekler.
         */
        function addRobot() {
            const newRobotId = `robot${Object.keys(robots).length + 1}`;
            const newRobotName = `New-Robot-${Object.keys(robots).length + 1}`;
            const statuses = ['online', 'warning', 'offline'];
            const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];

            robots[newRobotId] = {
                name: newRobotName,
                status: randomStatus,
                battery: Math.floor(Math.random() * 100),
                position: { x: Math.random() * 20, y: Math.random() * 10, theta: Math.random() * 360 },
                velocity: { linear: Math.random() * 2, angular: Math.random() * 0.5 },
                temperature: Math.floor(Math.random() * 20) + 20,
                system: { cpu: Math.floor(Math.random() * 80) + 10, memory: `${(Math.random() * 4 + 1).toFixed(1)}/8.0`, uptime: `0sa 0dk` },
                mapCoordX: Math.floor(Math.random() * 700) + 50,
                mapCoordY: Math.floor(Math.random() * 500) + 50
            };
            selectedRobot = newRobotId; // Yeni eklenen robotu seÃ§ili yap
            updateRobotList(); // Listeyi yeniden Ã§iz
            showNotification(translations[currentLanguage].notificationRobotAdded(newRobotName), 'success');
        }

        /**
         * SeÃ§ili robotu 'robots' nesnesinden ve arayÃ¼zden siler.
         * EÄŸer silinen robot seÃ§ili ise, baÅŸka bir robotu seÃ§er.
         */
        function deleteSelectedRobot() {
            if (!selectedRobot || Object.keys(robots).length === 0) {
                showNotification(translations[currentLanguage].notificationNoRobotToDelete, 'warning');
                return;
            }

            const robotToDeleteName = robots[selectedRobot].name;
            delete robots[selectedRobot];
            showNotification(translations[currentLanguage].notificationRobotDeleted(robotToDeleteName), 'info');
            updateRobotList(); // Listeyi yeniden Ã§iz ve seÃ§imi gÃ¼ncelle
        }

        /**
         * TÃ¼m robot iÅŸaretÃ§ilerinin gÃ¶rsel konumunu harita Ã¼zerinde gÃ¼nceller.
         */
        function updateMarkerVisuals() {
            const mapCanvas = document.getElementById('mapCanvas');
            if (!mapCanvas) return;

            const mapWidth = mapCanvas.offsetWidth;
            const mapHeight = mapCanvas.offsetHeight;
            const viewBoxWidth = 800;
            const viewBoxHeight = 600;

            // Ã–nce tÃ¼m eski iÅŸaretÃ§ileri kaldÄ±r
            document.querySelectorAll('.robot-marker').forEach(marker => marker.remove());

            for (const robotId in robots) {
                const robot = robots[robotId];
                if (robot) {
                    const markerElement = document.createElement('div');
                    markerElement.classList.add('robot-marker');
                    if (robotId === selectedRobot) {
                        markerElement.classList.add('selected');
                    }
                    markerElement.dataset.robot = robotId;
                    markerElement.style.zIndex = '2'; // SVG'nin Ã¼zerinde gÃ¶rÃ¼nmesini saÄŸlar
                    markerElement.textContent = 'ðŸ¤–'; // Robot ikonu

                    const markerSize = 30; // .robot-marker CSS'teki sabit geniÅŸlik/yÃ¼kseklik
                    const pixelX = (robot.mapCoordX / viewBoxWidth) * mapWidth - (markerSize / 2);
                    const pixelY = (robot.mapCoordY / viewBoxHeight) * mapHeight - (markerSize / 2);
                    
                    markerElement.style.left = `${pixelX}px`;
                    markerElement.style.top = `${pixelY}px`;

                    markerElement.addEventListener('click', function() {
                        const clickedRobotId = this.dataset.robot;
                        document.querySelectorAll('.robot-item').forEach(r => r.classList.remove('active'));
                        
                        const robotItemElement = document.querySelector(`.robot-item[data-robot="${clickedRobotId}"]`);
                        if(robotItemElement) { // Null kontrolÃ¼ eklendi
                            robotItemElement.classList.add('active');
                        }
                        
                        selectedRobot = clickedRobotId;
                        updateRobotData();
                        updateMarkerVisuals(); // Ä°ÅŸaretÃ§i seÃ§imini gÃ¶rsel olarak yenilemek iÃ§in
                    });
                    mapCanvas.appendChild(markerElement);
                }
            }
        }

        // Chart.js grafikleri iÃ§in global deÄŸiÅŸkenler
        let batteryChart, cpuUsageChart;
        const CHART_HISTORY_LENGTH = 20; // Grafikte gÃ¶sterilecek veri noktasÄ± sayÄ±sÄ±
        let batteryHistory = Array(CHART_HISTORY_LENGTH).fill(null);
        let cpuHistory = Array(CHART_HISTORY_LENGTH).fill(null);
        let chartLabels = Array(CHART_HISTORY_LENGTH).fill('');

        /**
         * BaÅŸlangÄ±Ã§ta Chart.js grafiklerini baÅŸlatÄ±r.
         */
        function initializeCharts() {
            const batteryCtx = document.getElementById('batteryChart');
            if (batteryCtx) { // Null kontrolÃ¼ eklendi
                batteryChart = new Chart(batteryCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            label: translations[currentLanguage].batteryStatusTitle, // Dil desteÄŸi
                            data: batteryHistory,
                            borderColor: 'rgb(34, 197, 94)', // YeÅŸil
                            backgroundColor: 'rgba(34, 197, 94, 0.2)',
                            fill: true,
                            tension: 0.3,
                            pointRadius: 0 // NoktalarÄ± gizle
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 0 // Animasyonu kapat
                        },
                        scales: {
                            x: {
                                display: false // X eksenini gizle
                            },
                            y: {
                                min: 0,
                                max: 100,
                                ticks: {
                                    callback: function(value) { return value + '%'; },
                                    color: getComputedStyle(document.body).getPropertyValue('--text-color-primary'), // Dinamik renk
                                },
                                grid: {
                                    color: getComputedStyle(document.body).getPropertyValue('--grid-color') // Dinamik renk
                                }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false } // Tooltip'leri gizle
                        }
                    }
                });
            }


            const cpuCtx = document.getElementById('cpuUsageChart');
            if (cpuCtx) { // Null kontrolÃ¼ eklendi
                cpuUsageChart = new Chart(cpuCtx.getContext('2d'), {
                    type: 'line',
                    data: {
                        labels: chartLabels,
                        datasets: [{
                            label: translations[currentLanguage].cpuUsageLabel, // Dil desteÄŸi
                            data: cpuHistory,
                            borderColor: 'rgb(99, 102, 241)', // Mor
                            backgroundColor: 'rgba(99, 102, 241, 0.2)',
                            fill: true,
                            tension: 0.3,
                            pointRadius: 0 // NoktalarÄ± gizle
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: {
                            duration: 0
                        },
                        scales: {
                            x: {
                                display: false
                            },
                            y: {
                                min: 0,
                                max: 100,
                                ticks: {
                                    callback: function(value) { return value + '%'; },
                                    color: getComputedStyle(document.body).getPropertyValue('--text-color-primary'),
                                },
                                grid: {
                                    color: getComputedStyle(document.body).getPropertyValue('--grid-color')
                                }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: { enabled: false }
                        }
                    }
                });
            }
            updateChartThemes(); // Tema renklerini baÅŸlangÄ±Ã§ta ayarla
        }

        /**
         * Tema deÄŸiÅŸtiÄŸinde grafiklerin renklerini gÃ¼nceller.
         */
        function updateChartThemes() {
            const isDark = document.body.classList.contains('dark-theme');
            // Root CSS deÄŸiÅŸkenlerini gÃ¼ncelleyelim
            document.documentElement.style.setProperty('--text-color-primary', isDark ? '#e2e8f0' : '#333');
            document.documentElement.style.setProperty('--grid-color', isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(0, 0, 0, 0.1)');
            document.documentElement.style.setProperty('--glass-bg-light', isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(255, 255, 255, 0.1)');
            document.documentElement.style.setProperty('--glass-border-light', isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(255, 255, 255, 0.1)');
            document.documentElement.style.setProperty('--glass-shadow-light', isDark ? 'rgba(0, 0, 0, 0.5)' : 'rgba(0, 0, 0, 0.25)');
            
            // Scrollbar deÄŸiÅŸkenlerini gÃ¼ncelle
            document.documentElement.style.setProperty('--scrollbar-track-color', isDark ? 'rgba(15, 23, 42, 0.5)' : 'rgba(255, 255, 255, 0.15)');
            document.documentElement.style.setProperty('--scrollbar-thumb-color', isDark ? 'rgba(96, 165, 250, 0.7)' : 'rgba(102, 126, 234, 0.7)');
            document.documentElement.style.setProperty('--scrollbar-thumb-hover-color', isDark ? 'rgba(96, 165, 250, 1)' : 'rgba(102, 126, 234, 1)');

            // Glassmorphism Buton deÄŸiÅŸkenlerini gÃ¼ncelle
            document.documentElement.style.setProperty('--glass-button-bg-light', isDark ? 'rgba(255, 255, 255, 0.05)' : 'rgba(255, 255, 255, 0.2)');
            document.documentElement.style.setProperty('--glass-button-border-light', isDark ? 'rgba(255, 255, 255, 0.1)' : 'rgba(255, 255, 255, 0.4)');
            document.documentElement.style.setProperty('--glass-button-shadow-light', isDark ? 'rgba(0, 0, 0, 0.3)' : 'rgba(0, 0, 0, 0.1)');
            // Buton metin rengi deÄŸiÅŸkenlerini gÃ¼ncelle
            document.documentElement.style.setProperty('--glass-button-text-light', isDark ? '#e2e8f0' : '#667eea');
            document.documentElement.style.setProperty('--glass-button-text-dark', isDark ? '#e2e8f0' : '#60a5fa');


            // Grafiklerin kendilerini gÃ¼ncelleyelim
            if (batteryChart) {
                batteryChart.options.scales.y.ticks.color = getComputedStyle(document.body).getPropertyValue('--text-color-primary');
                batteryChart.options.scales.y.grid.color = getComputedStyle(document.body).getPropertyValue('--grid-color');
                batteryChart.data.datasets[0].label = translations[currentLanguage].batteryStatusTitle;
                batteryChart.update();
            }
            if (cpuUsageChart) {
                cpuUsageChart.options.scales.y.ticks.color = getComputedStyle(document.body).getPropertyValue('--text-color-primary');
                cpuUsageChart.options.scales.y.grid.color = getComputedStyle(document.body).getPropertyValue('--grid-color');
                cpuUsageChart.data.datasets[0].label = translations[currentLanguage].cpuUsageLabel;
                cpuUsageChart.update();
            }
        }

        /**
         * Dashboard gÃ¶rÃ¼nÃ¼mÃ¼nÃ¼ ÅŸu anda seÃ§ili olan robotun verileriyle gÃ¼nceller.
         */
        function updateRobotData() {
            const robot = robots[selectedRobot]; 
            
            // TÃ¼m gÃ¼ncellenecek Ã¶ÄŸeleri bir kez alÄ±p, varlÄ±klarÄ±nÄ± kontrol et
            const batteryLevelEl = document.getElementById('batteryLevel');
            const batteryProgressEl = document.getElementById('batteryProgress');
            const voltageEl = document.getElementById('voltage');
            const currentEl = document.getElementById('current');
            const posXEl = document.getElementById('posX');
            const posYEl = document.getElementById('posY');
            const posThetaEl = document.getElementById('posTheta');
            const linearSpeedEl = document.getElementById('linearSpeed');
            const linearVelEl = document.getElementById('linearVel');
            const angularVelEl = document.getElementById('angularVel');
            const temperatureEl = document.getElementById('temperature');
            const cpuTempEl = document.getElementById('cpuTemp');
            const gpuTempEl = document.getElementById('gpuTemp');
            const cpuUsageEl = document.getElementById('cpuUsage');
            const memUsageEl = document.getElementById('memUsage');
            const uptimeEl = document.getElementById('uptime');

            if (!robot) {
                // SeÃ§ili robot yoksa veya silindiyse, UI'yÄ± temizle
                if (batteryLevelEl) batteryLevelEl.textContent = '--%';
                if (batteryProgressEl) batteryProgressEl.style.width = '0%';
                if (voltageEl) voltageEl.textContent = '--V'; 
                if (currentEl) currentEl.textContent = '--A';
                if (posXEl) posXEl.textContent = '--.--';
                if (posYEl) posYEl.textContent = '--.--';
                if (posThetaEl) posThetaEl.textContent = '--.-Â°';
                if (linearSpeedEl) linearSpeedEl.textContent = '-- m/s';
                if (linearVelEl) linearVelEl.textContent = '--.--';
                if (angularVelEl) angularVelEl.textContent = '--.--';
                if (temperatureEl) temperatureEl.textContent = '--Â°C';
                if (cpuTempEl) cpuTempEl.textContent = '--Â°C';
                if (gpuTempEl) gpuTempEl.textContent = '--Â°C';
                if (cpuUsageEl) cpuUsageEl.textContent = '--%';
                if (memUsageEl) memUsageEl.textContent = '--/-- GB';
                if (uptimeEl) uptimeEl.textContent = '--sa --dk';

                // Grafik geÃ§miÅŸlerini temizle
                batteryHistory = Array(CHART_HISTORY_LENGTH).fill(null);
                cpuHistory = Array(CHART_HISTORY_LENGTH).fill(null);
                chartLabels = Array(CHART_HISTORY_LENGTH).fill('');

                if (batteryChart) {
                    batteryChart.data.datasets[0].data = batteryHistory;
                    batteryChart.data.labels = chartLabels;
                    batteryChart.update();
                }
                if (cpuUsageChart) {
                    cpuUsageChart.data.datasets[0].data = cpuHistory;
                    cpuUsageChart.data.labels = chartLabels;
                    cpuUsageChart.update();
                }

                return;
            }

            // Batarya Durumu KartÄ±nÄ± GÃ¼ncelle
            if (batteryLevelEl) batteryLevelEl.textContent = robot.battery.toFixed(0) + '%';
            if (batteryProgressEl) batteryProgressEl.style.width = robot.battery + '%';
            if (voltageEl) voltageEl.textContent = '24.3V'; 
            if (currentEl) currentEl.textContent = '-2.1A';
            
            // Konum KartÄ±nÄ± GÃ¼ncelle
            if (posXEl) posXEl.textContent = robot.position.x.toFixed(2);
            if (posYEl) posYEl.textContent = robot.position.y.toFixed(2);
            if (posThetaEl) posThetaEl.textContent = robot.position.theta.toFixed(1) + 'Â°';
            
            // HÄ±z KartÄ±nÄ± GÃ¼ncelle
            if (linearSpeedEl) linearSpeedEl.textContent = parseFloat(robot.velocity.linear).toFixed(1) + ' m/s';
            if (linearVelEl) linearVelEl.textContent = parseFloat(robot.velocity.linear).toFixed(1);
            if (angularVelEl) angularVelEl.textContent = parseFloat(robot.velocity.angular).toFixed(1);
            
            // SÄ±caklÄ±k KartÄ±nÄ± GÃ¼ncelle
            if (temperatureEl) temperatureEl.textContent = robot.temperature.toFixed(0) + 'Â°C';
            if (cpuTempEl) cpuTempEl.textContent = '38Â°C';
            if (gpuTempEl) gpuTempEl.textContent = '45Â°C';
            
            // Sistem Durumu KartÄ±nÄ± GÃ¼ncelle
            if (cpuUsageEl) cpuUsageEl.textContent = robot.system.cpu.toFixed(0) + '%';
            if (memUsageEl) memUsageEl.textContent = robot.system.memory + ' GB';
            if (uptimeEl) uptimeEl.textContent = robot.system.uptime;

            // Chart.js verilerini gÃ¼ncelle
            // Her dÃ¶ngÃ¼de yeni veri ekle ve en eskini kaldÄ±r
            batteryHistory.shift();
            batteryHistory.push(robot.battery);
            
            cpuHistory.shift();
            cpuHistory.push(robot.system.cpu);
            
            // Etiketleri gÃ¼ncelle (basit bir zaman damgasÄ± veya sadece boÅŸ)
            chartLabels.shift();
            chartLabels.push(new Date().toLocaleTimeString()); // Her seferde yeni zaman damgasÄ± ekle

            if (batteryChart && cpuUsageChart) {
                batteryChart.data.datasets[0].data = batteryHistory;
                batteryChart.data.labels = chartLabels;
                batteryChart.update();

                cpuUsageChart.data.datasets[0].data = cpuHistory;
                cpuUsageChart.data.labels = chartLabels;
                cpuUsageChart.update();
            }
        }

        // Robot verileri iÃ§in gerÃ§ek zamanlÄ± gÃ¼ncellemeleri simÃ¼le et
        setInterval(() => {
            // Sadece seÃ§ili robotun verilerini gÃ¼ncelle, diÄŸerlerini pas geÃ§
            if (selectedRobot && robots[selectedRobot]) {
                const robot = robots[selectedRobot];
                robot.battery = Math.max(0, robot.battery - 0.05); // Daha yavaÅŸ boÅŸalma
                
                // Robot iÃ§in dairesel hareket hesaplamasÄ±
                const time = Date.now() * 0.001; // Saniye cinsinden zaman
                const centerX = 300; // viewBox'a gÃ¶re
                const centerY = 250; // viewBox'a gÃ¶re
                const radius = 80; // viewBox'a gÃ¶re
                
                robot.mapCoordX = (centerX + Math.cos(time) * radius);
                robot.mapCoordY = (centerY + Math.sin(time) * radius);
                
                robot.velocity.linear = (1.0 + Math.sin(time) * 0.5);
                robot.velocity.angular = (Math.cos(time) * 0.2);
                
                robot.position.x = (12 + Math.cos(time) * 5);
                robot.position.y = (-5 + Math.sin(time) * 3);
                robot.position.theta = (time * 57.3) % 360; // Dereceye dÃ¶nÃ¼ÅŸtÃ¼r (yaklaÅŸÄ±k)
                
                robot.system.cpu = Math.min(100, 20 + Math.sin(time * 0.5) * 15 + Math.random() * 10);
                
                updateRobotData(); // GÃ¶rÃ¼ntÃ¼lenen metin verilerini yenile
                updateMarkerVisuals(); // TÃ¼m iÅŸaretÃ§ilerin gÃ¶rsel konumlarÄ±nÄ± yenile
            } else {
                updateRobotData(); // SeÃ§ili robot yoksa UI'yÄ± temizle
            }
        }, 1000); // Her saniyede bir gÃ¼ncelleme

        /**
         * Verilen bir HTML Ã¶ÄŸesinin etkileÅŸimli bir Ã¶ÄŸe (buton, link, select vb.) olup olmadÄ±ÄŸÄ±nÄ± kontrol eder.
         * TÄ±klanan Ã¶ÄŸeden baÅŸlayarak DOM aÄŸacÄ±nda yukarÄ± doÄŸru ilerleyerek ebeveynleri de kontrol eder.
         * Bu, sÃ¼rÃ¼kle-bÄ±rak olaylarÄ±nÄ±n yanlÄ±ÅŸlÄ±kla etkileÅŸimli Ã¶ÄŸeleri tetiklemesini Ã¶nlemek iÃ§in kullanÄ±lÄ±r.
         * @param {HTMLElement} element - Kontrol edilecek HTML Ã¶ÄŸesi.
         * @returns {boolean} Ã–ÄŸenin veya bir ebeveyninin etkileÅŸimli bir Ã¶ÄŸe olup olmadÄ±ÄŸÄ±.
         */
        function isInteractiveElement(element) {
            // EtkileÅŸimli olarak kabul edilen HTML etiket adlarÄ±
            const interactiveTags = ['BUTTON', 'A', 'SELECT', 'INPUT', 'TEXTAREA'];
            // EtkileÅŸimli olarak kabul edilen CSS sÄ±nÄ±flarÄ±
            const interactiveClasses = [
                'sidebar-action-btn', 'control-btn', 'camera-btn', 'snapshot-btn',
                'fullscreen-btn', 'theme-toggle', 'nav-item', 'robot-item', 'language-select'
            ];

            let currentElement = element;
            while (currentElement && currentElement !== document.body) {
                // Etiketi kontrol et
                if (interactiveTags.includes(currentElement.tagName)) {
                    return true;
                }
                // SÄ±nÄ±flarÄ± kontrol et
                for (const cls of interactiveClasses) {
                    if (currentElement.classList.contains(cls)) {
                        return true;
                    }
                }
                currentElement = currentElement.parentElement; // Bir Ã¼st ebeveyne geÃ§
            }
            return false;
        }

        // --- SÃ¼rÃ¼kle ve BÄ±rak Ä°ÅŸlevselliÄŸi ---
        let draggedItem = null; // SÃ¼rÃ¼klenen Ã¶ÄŸeyi saklar

        // Sadece saÄŸ kenar Ã§ubuÄŸundaki `.status-card` Ã¶ÄŸelerini seÃ§
        const draggableCards = document.querySelectorAll('.right-sidebar .status-card');

        draggableCards.forEach(card => {
            card.addEventListener('dragstart', (e) => {
                // EÄŸer tÄ±klanan Ã¶ÄŸe veya ebeveynlerinden biri etkileÅŸimli bir Ã¶ÄŸeyse, sÃ¼rÃ¼klemeyi engelle
                if (isInteractiveElement(e.target)) {
                    e.preventDefault(); // SÃ¼rÃ¼kleme iÅŸlemini iptal et
                    e.stopPropagation(); // OlayÄ±n daha fazla yayÄ±lmasÄ±nÄ± engelle
                    return;
                }
                draggedItem = e.target;
                e.target.classList.add('dragging'); // SÃ¼rÃ¼klÃ¼ Ã¶ÄŸeye sÄ±nÄ±f ekle
                // Ã–zel sÃ¼rÃ¼kleme gÃ¶rÃ¼ntÃ¼sÃ¼ ayarla (isteÄŸe baÄŸlÄ±, genellikle tarayÄ±cÄ± varsayÄ±lanÄ± yeterlidir)
                // e.dataTransfer.setDragImage(e.target, e.offsetX, e.offsetY);
            });

            card.addEventListener('dragend', (e) => {
                if (draggedItem) {
                    draggedItem.classList.remove('dragging');
                    draggedItem = null;
                }
            });
        });

        // Main container veya kartlarÄ±n ebeveyni Ã¼zerinde dragover olay dinleyici
        // Bu, sÃ¼rÃ¼kleme sÄ±rasÄ±nda Ã¶ÄŸelerin yeniden sÄ±ralanmasÄ±nÄ± saÄŸlar
        document.querySelector('.main-container').addEventListener('dragover', (e) => {
            e.preventDefault(); // BÄ±rakmaya izin ver
            if (draggedItem && draggedItem.classList.contains('status-card')) { // Sadece kartlarÄ± sÃ¼rÃ¼kle
                const container = draggedItem.parentElement; // SÃ¼rÃ¼klenen Ã¶ÄŸenin mevcut ebeveynini kullan
                if (container && container.classList.contains('right-sidebar')) {
                    // Sadece saÄŸ kenar Ã§ubuÄŸundaki kartlarÄ± yeniden sÄ±rala
                    const afterElement = getDragAfterElement(container, e.clientY);
                    if (afterElement == null) {
                        container.appendChild(draggedItem);
                    } else {
                        container.insertBefore(draggedItem, afterElement);
                    }
                }
            }
        });

        document.querySelector('.main-container').addEventListener('drop', (e) => {
            e.preventDefault();
            if (draggedItem) {
                draggedItem.classList.remove('dragging');
                draggedItem = null; // SÃ¼rÃ¼klÃ¼ Ã¶ÄŸeyi sÄ±fÄ±rla
            }
        });

        /**
         * SÃ¼rÃ¼klenen Ã¶ÄŸenin fare Y konumuna gÃ¶re nereye ekleneceÄŸini belirler.
         * Fareye en yakÄ±n olan ve sÃ¼rÃ¼klenen Ã¶ÄŸe olmayan Ã¶ÄŸeyi bulur.
         * @param {HTMLElement} container - Ã–ÄŸelerin sÃ¼rÃ¼klendiÄŸi konteyner.
         * @param {number} y - Farenin clientY koordinatÄ±.
         * @returns {HTMLElement|null} Ã–nÃ¼ne eklenecek Ã¶ÄŸe veya en sondaysa null.
         */
        function getDragAfterElement(container, y) {
            // Konteyner iÃ§indeki sÃ¼rÃ¼klenmeyen tÃ¼m Ã¶ÄŸeleri al
            const draggableElements = [...container.querySelectorAll('.status-card:not(.dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2; // Ã‡ocuÄŸun merkezinden uzaklÄ±ÄŸÄ± hesapla
                // Ofset negatifse ve mevcut en yakÄ±n olandan daha yakÄ±nsa, bu, Ã¶nÃ¼ne eklenecek Ã¶ÄŸedir
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element; // Ã‡ok kÃ¼Ã§Ã¼k bir ofsetle baÅŸlat
        }

        // --- GEMINI API ENTEGRASYONU ---

        /**
         * SeÃ§ili robotun mevcut durumunu analiz etmek iÃ§in Gemini API'yi Ã§aÄŸÄ±rÄ±r.
         * Analiz sonucunu bir modal pencerede gÃ¶sterir.
         */
        async function analyzeRobotStatus() {
            const robot = robots[selectedRobot];
            if (!robot) {
                showNotification(translations[currentLanguage].notificationNoRobotForAnalysis, 'warning');
                return;
            }

            const modalOverlay = document.getElementById('analysisModalOverlay');
            const analysisResultDiv = document.getElementById('analysisResult');
            const analysisSpinner = document.getElementById('analysisSpinner');

            if (modalOverlay && analysisResultDiv && analysisSpinner) { // TÃ¼m elemanlarÄ±n var olduÄŸunu kontrol et
                // ModalÄ± gÃ¶ster ve spinner'Ä± aktif et
                analysisResultDiv.textContent = ''; // Ã–nceki analizi temizle
                analysisSpinner.style.display = 'block';
                modalOverlay.classList.add('show');
            }


            const prompt = `
            ${translations[currentLanguage].analysisPromptPrefix}
            - ${translations[currentLanguage].robotNameLabel}: ${robot.name}
            - ${translations[currentLanguage].generalStatusLabel}: ${robot.status}
            - ${translations[currentLanguage].batteryPercentageLabel}: ${robot.battery.toFixed(0)}%
            - ${translations[currentLanguage].positionLabel} (X, Y, Theta): (${robot.position.x.toFixed(2)}m, ${robot.position.y.toFixed(2)}m, ${robot.position.theta.toFixed(1)}Â°)
            - ${translations[currentLanguage].linearSpeedLabel}: ${robot.velocity.linear.toFixed(1)} m/s
            - ${translations[currentLanguage].angularSpeedLabel}: ${robot.velocity.angular.toFixed(1)} rad/s
            - ${translations[currentLanguage].temperatureLabel}: ${robot.temperature.toFixed(0)}Â°C
            - ${translations[currentLanguage].cpuUsageLabel}: ${robot.system.cpu.toFixed(0)}%
            - ${translations[currentLanguage].memoryUsageLabel}: ${robot.system.memory} GB
            - ${translations[currentLanguage].uptimeLabel}: ${robot.system.uptime}

            ${translations[currentLanguage].analysisPromptSuffix}
            `;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; // API anahtarÄ± Canvas tarafÄ±ndan saÄŸlanacaktÄ±r
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const analysisText = result.candidates[0].content.parts[0].text;
                    if (analysisResultDiv) analysisResultDiv.textContent = analysisText; // Null kontrolÃ¼ eklendi
                } else {
                    if (analysisResultDiv) analysisResultDiv.textContent = translations[currentLanguage].analysisErrorApi; // Null kontrolÃ¼ eklendi
                    console.error('Gemini API yanÄ±t yapÄ±sÄ± beklenmedik:', result);
                }
            } catch (error) {
                if (analysisResultDiv) analysisResultDiv.textContent = translations[currentLanguage].analysisErrorNetwork; // Null kontrolÃ¼ eklendi
                console.error('Gemini API Ã§aÄŸrÄ±sÄ± sÄ±rasÄ±nda hata:', error);
            } finally {
                if (analysisSpinner) analysisSpinner.style.display = 'none'; // Spinner'Ä± gizle // Null kontrolÃ¼ eklendi
            }
        }

        // Gemini API prompt iÃ§in ek Ã§eviri anahtarlarÄ±
        translations.en.analysisPromptPrefix = 'The current status of the selected robot is as follows:';
        translations.en.analysisPromptSuffix = 'Based on this data, provide a brief analysis of the robot\'s current status and suggest possible solutions if there is a problem. Provide the answer as plain text formatted in English.';
        translations.en.robotNameLabel = 'Name';
        translations.en.generalStatusLabel = 'General Status';
        translations.en.batteryPercentageLabel = 'Battery Percentage';
        translations.en.positionLabel = 'Position';
        translations.en.linearSpeedLabel = 'Linear Speed';
        translations.en.angularSpeedLabel = 'Angular Speed';
        translations.en.temperatureLabel = 'Temperature';
        translations.en.cpuUsageLabel = 'CPU Usage';
        translations.en.memoryUsageLabel = 'Memory Usage';
        translations.en.uptimeLabel = 'Uptime';

        translations.tr.analysisPromptPrefix = 'Åžu anda seÃ§ili robotun durumu ÅŸÃ¶yledir:';
        translations.tr.analysisPromptSuffix = 'Bu verilere dayanarak, robotun mevcut durumu hakkÄ±nda kÄ±sa bir analiz yap ve eÄŸer bir sorun varsa olasÄ± Ã§Ã¶zÃ¼m Ã¶nerileri sun. YanÄ±tÄ± TÃ¼rkÃ§e olarak biÃ§imlendirilmiÅŸ dÃ¼z metin olarak ver.';
        translations.tr.robotNameLabel = 'AdÄ±';
        translations.tr.generalStatusLabel = 'Genel Durum';
        translations.tr.batteryPercentageLabel = 'Batarya YÃ¼zdesi';
        translations.tr.positionLabel = 'Konum';
        translations.tr.linearSpeedLabel = 'DoÄŸrusal HÄ±z';
        translations.tr.angularSpeedLabel = 'AÃ§Ä±sal HÄ±z';
        translations.tr.temperatureLabel = 'SÄ±caklÄ±k';
        translations.tr.cpuUsageLabel = 'CPU KullanÄ±mÄ±';
        translations.tr.memoryUsageLabel = 'Bellek KullanÄ±mÄ±';
        translations.tr.uptimeLabel = 'Ã‡alÄ±ÅŸma SÃ¼resi';

        /**
         * Analiz modalÄ±nÄ± kapatÄ±r.
         */
        function closeAnalysisModal() {
            const modalOverlay = document.getElementById('analysisModalOverlay');
            if (modalOverlay) { // Null kontrolÃ¼ eklendi
                modalOverlay.classList.remove('show');
                document.body.style.overflow = ''; // Sayfa kaydÄ±rmasÄ±nÄ± geri aÃ§
            }
        }

        // Sayfa yÃ¼klendiÄŸinde dashboard'u baÅŸlat
        initSettings(); // Tema ve dil ayarlarÄ±nÄ± baÅŸlat
        initializeCharts(); // Grafikleri baÅŸlat
        updateRobotList(); // BaÅŸlangÄ±Ã§ta robot listesini yÃ¼kle
        
        // Pencere yeniden boyutlandÄ±rÄ±ldÄ±ÄŸÄ±nda iÅŸaretÃ§ileri ve grafikleri gÃ¼ncelle
        window.addEventListener('resize', () => {
            updateMarkerVisuals();
            if (batteryChart) batteryChart.resize();
            if (cpuUsageChart) cpuUsageChart.resize();
        });

        console.log('Dashboard mock verileri, sÃ¼rÃ¼kle-bÄ±rak iÅŸlevselliÄŸi, grafikler ve robot ekleme/silme ile baÅŸlatÄ±ldÄ±. ROS2 entegrasyonu iÃ§in hazÄ±r!');
    </script>
</body>
</html>
